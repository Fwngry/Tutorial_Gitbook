
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>üåüPytorch Êê≠Âª∫ YoloV4 ÁõÆÊ†áÊ£ÄÊµãÂπ≥Âè∞ ¬∑ Summary</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-anchor-navigation-ex/style/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search-pro/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-splitter/splitter.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="yolo--- ÂèÇÊï∞Ëß£Èáä‰πã cfg Êñá‰ª∂ÂèÇÊï∞.html" />
    
    
    <link rel="prev" href="YOLOÂÆûÈ™å/Á¨îËÆ∞ - Âú®ÊúçÂä°Âô®‰∏äÁî® YOLOv4 ËÆ≠ÁªÉÂíåÊµãËØïÊï∞ÊçÆÈõÜ.html" />
    

    <style>
    @media only screen and (max-width: 640px) {
        .book-header .hidden-mobile {
            display: none;
        }
    }
    </style>
    <script>
        window["gitbook-plugin-github-buttons"] = {};
    </script>

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" >
            
                <span>
            
                    
                    0 - Âø´ÈÄü‰ΩøÁî®
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../0 - Âø´ÈÄü‰ΩøÁî®/3 ÂàÜÈíüÂø´ÈÄüÈÖçÁΩÆ Git.html">
            
                <a href="../0 - Âø´ÈÄü‰ΩøÁî®/3 ÂàÜÈíüÂø´ÈÄüÈÖçÁΩÆ Git.html">
            
                    
                    3 ÂàÜÈíüÂø´ÈÄüÈÖçÁΩÆ Git
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../0 - Âø´ÈÄü‰ΩøÁî®/Conda Â∏∏Áî®ÂëΩ‰ª§Êï¥ÁêÜ.html">
            
                <a href="../0 - Âø´ÈÄü‰ΩøÁî®/Conda Â∏∏Áî®ÂëΩ‰ª§Êï¥ÁêÜ.html">
            
                    
                    Conda Â∏∏Áî®ÂëΩ‰ª§Êï¥ÁêÜ
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../0 - Âø´ÈÄü‰ΩøÁî®/Linux&ShellÂ∏∏Áî®ÂëΩ‰ª§Êï¥ÁêÜ.html">
            
                <a href="../0 - Âø´ÈÄü‰ΩøÁî®/Linux&ShellÂ∏∏Áî®ÂëΩ‰ª§Êï¥ÁêÜ.html">
            
                    
                    Linux&ShellÂ∏∏Áî®ÂëΩ‰ª§Êï¥ÁêÜ
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="../0 - Âø´ÈÄü‰ΩøÁî®/MacOSÂ∏∏Áî®ÂëΩ‰ª§Êï¥ÁêÜ.html">
            
                <a href="../0 - Âø´ÈÄü‰ΩøÁî®/MacOSÂ∏∏Áî®ÂëΩ‰ª§Êï¥ÁêÜ.html">
            
                    
                    MacOSÂ∏∏Áî®ÂëΩ‰ª§Êï¥ÁêÜ
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="../0 - Âø´ÈÄü‰ΩøÁî®/Pycharm.html">
            
                <a href="../0 - Âø´ÈÄü‰ΩøÁî®/Pycharm.html">
            
                    
                    Pycharm
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6" data-path="../0 - Âø´ÈÄü‰ΩøÁî®/VSCODEÂ∏∏Áî®Âø´Êç∑ÈîÆÊï¥ÁêÜ.html">
            
                <a href="../0 - Âø´ÈÄü‰ΩøÁî®/VSCODEÂ∏∏Áî®Âø´Êç∑ÈîÆÊï¥ÁêÜ.html">
            
                    
                    VSCODEÂ∏∏Áî®Âø´Êç∑ÈîÆÊï¥ÁêÜ
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.7" data-path="../0 - Âø´ÈÄü‰ΩøÁî®/XCODEÂ∏∏Áî®Âø´Êç∑ÈîÆÊï¥ÁêÜ.html">
            
                <a href="../0 - Âø´ÈÄü‰ΩøÁî®/XCODEÂ∏∏Áî®Âø´Êç∑ÈîÆÊï¥ÁêÜ.html">
            
                    
                    XCODEÂ∏∏Áî®Âø´Êç∑ÈîÆÊï¥ÁêÜ
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" >
            
                <span>
            
                    
                    1 Git Github
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../1 - Git_Github/1. GithubÊ∑ªÂä†ÂÖ¨Èí•.html">
            
                <a href="../1 - Git_Github/1. GithubÊ∑ªÂä†ÂÖ¨Èí•.html">
            
                    
                    1. GithubÊ∑ªÂä†ÂÖ¨Èí•
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../1 - Git_Github/2. ÂÖ≥‰∫égit clone.html">
            
                <a href="../1 - Git_Github/2. ÂÖ≥‰∫égit clone.html">
            
                    
                    2. ÂÖ≥‰∫égit clone
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../1 - Git_Github/3. ÂÖ≥‰∫é.gitconfig.html">
            
                <a href="../1 - Git_Github/3. ÂÖ≥‰∫é.gitconfig.html">
            
                    
                    3. ÂÖ≥‰∫é.gitconfig
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="../1 - Git_Github/4. ÂÖ≥‰∫é.gitignore.html">
            
                <a href="../1 - Git_Github/4. ÂÖ≥‰∫é.gitignore.html">
            
                    
                    4. ÂÖ≥‰∫é.gitignore
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="../1 - Git_Github/5. ‰∏ãËΩΩgithubÁâπÂÆöÂ≠êÊñá‰ª∂Â§π.html">
            
                <a href="../1 - Git_Github/5. ‰∏ãËΩΩgithubÁâπÂÆöÂ≠êÊñá‰ª∂Â§π.html">
            
                    
                    5. ‰∏ãËΩΩgithubÁâπÂÆöÂ≠êÊñá‰ª∂Â§π
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6" data-path="../1 - Git_Github/6. git branch.html">
            
                <a href="../1 - Git_Github/6. git branch.html">
            
                    
                    6. git branch
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.7" data-path="../1 - Git_Github/7. git fetch & pull ËØ¶Ëß£.html">
            
                <a href="../1 - Git_Github/7. git fetch & pull ËØ¶Ëß£.html">
            
                    
                    7. git fetch & pull ËØ¶Ëß£
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.8" data-path="../1 - Git_Github/8. Gitbook‰∏éGitPages.html">
            
                <a href="../1 - Git_Github/8. Gitbook‰∏éGitPages.html">
            
                    
                    8. Gitbook‰∏éGitPages
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.9" data-path="../1 - Git_Github/Êä•Èîô - Failed to connect to localhost port 1080: Connection refused.html">
            
                <a href="../1 - Git_Github/Êä•Èîô - Failed to connect to localhost port 1080: Connection refused.html">
            
                    
                    Êä•Èîô - Failed to connect to localhost port 1080: Connection refused
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" >
            
                <span>
            
                    
                    2 - Êìç‰ΩúÁ≥ªÁªü_ÊúçÂä°Âô®‰∏éÁΩëÁªú
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../2 - Êìç‰ΩúÁ≥ªÁªü_ÊúçÂä°Âô®‰∏éÁΩëÁªú/1. Download Ubuntu ÈïúÂÉèÊñá‰ª∂.html">
            
                <a href="../2 - Êìç‰ΩúÁ≥ªÁªü_ÊúçÂä°Âô®‰∏éÁΩëÁªú/1. Download Ubuntu ÈïúÂÉèÊñá‰ª∂.html">
            
                    
                    1. Download Ubuntu ÈïúÂÉèÊñá‰ª∂
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../2 - Êìç‰ΩúÁ≥ªÁªü_ÊúçÂä°Âô®‰∏éÁΩëÁªú/1. Ubuntu‰∏ãÁöÑÁøªÂ¢ôÊîªÁï•.html">
            
                <a href="../2 - Êìç‰ΩúÁ≥ªÁªü_ÊúçÂä°Âô®‰∏éÁΩëÁªú/1. Ubuntu‰∏ãÁöÑÁøªÂ¢ôÊîªÁï•.html">
            
                    
                    1. Ubuntu‰∏ãÁöÑÁøªÂ¢ôÊîªÁï•
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../2 - Êìç‰ΩúÁ≥ªÁªü_ÊúçÂä°Âô®‰∏éÁΩëÁªú/1. ÂÖçÁñ´ÊåÇÊñ≠Ôºönohup Âíå & .html">
            
                <a href="../2 - Êìç‰ΩúÁ≥ªÁªü_ÊúçÂä°Âô®‰∏éÁΩëÁªú/1. ÂÖçÁñ´ÊåÇÊñ≠Ôºönohup Âíå & .html">
            
                    
                    1. ÂÖçÁñ´ÊåÇÊñ≠Ôºönohup Âíå & 
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../2 - Êìç‰ΩúÁ≥ªÁªü_ÊúçÂä°Âô®‰∏éÁΩëÁªú/3. NATAPP Â∞ÜÂÜÖÁΩëÊò†Â∞ÑÂà∞Â§ñÁΩë.html">
            
                <a href="../2 - Êìç‰ΩúÁ≥ªÁªü_ÊúçÂä°Âô®‰∏éÁΩëÁªú/3. NATAPP Â∞ÜÂÜÖÁΩëÊò†Â∞ÑÂà∞Â§ñÁΩë.html">
            
                    
                    3. NATAPP Â∞ÜÂÜÖÁΩëÊò†Â∞ÑÂà∞Â§ñÁΩë
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5" data-path="../2 - Êìç‰ΩúÁ≥ªÁªü_ÊúçÂä°Âô®‰∏éÁΩëÁªú/3. ÂÆûÈ™åÂÆ§‰∏ªÊú∫ËÅîÁΩëÂ•áÊÄ™ÁªèÂéÜ.html">
            
                <a href="../2 - Êìç‰ΩúÁ≥ªÁªü_ÊúçÂä°Âô®‰∏éÁΩëÁªú/3. ÂÆûÈ™åÂÆ§‰∏ªÊú∫ËÅîÁΩëÂ•áÊÄ™ÁªèÂéÜ.html">
            
                    
                    3. ÂÆûÈ™åÂÆ§‰∏ªÊú∫ËÅîÁΩëÂ•áÊÄ™ÁªèÂéÜ
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6" data-path="../2 - Êìç‰ΩúÁ≥ªÁªü_ÊúçÂä°Âô®‰∏éÁΩëÁªú/3. ÊúçÂä°Âô®‰∏éMacOS‰πãÈó¥ÁöÑSFTP.html">
            
                <a href="../2 - Êìç‰ΩúÁ≥ªÁªü_ÊúçÂä°Âô®‰∏éÁΩëÁªú/3. ÊúçÂä°Âô®‰∏éMacOS‰πãÈó¥ÁöÑSFTP.html">
            
                    
                    3. ÊúçÂä°Âô®‰∏éMacOS‰πãÈó¥ÁöÑSFTP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.7" data-path="../2 - Êìç‰ΩúÁ≥ªÁªü_ÊúçÂä°Âô®‰∏éÁΩëÁªú/3. ËøúÁ®ãËøûÊé•ÊúçÂä°Âô® - NatappÂÜÖÁΩëÁ©øÈÄèÊúçÂä°Âô®.html">
            
                <a href="../2 - Êìç‰ΩúÁ≥ªÁªü_ÊúçÂä°Âô®‰∏éÁΩëÁªú/3. ËøúÁ®ãËøûÊé•ÊúçÂä°Âô® - NatappÂÜÖÁΩëÁ©øÈÄèÊúçÂä°Âô®.html">
            
                    
                    3. ËøúÁ®ãËøûÊé•ÊúçÂä°Âô® - NatappÂÜÖÁΩëÁ©øÈÄèÊúçÂä°Âô®
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8" data-path="../2 - Êìç‰ΩúÁ≥ªÁªü_ÊúçÂä°Âô®‰∏éÁΩëÁªú/4. CMake3ÂàÜÈíü‰∏äÊâã.html">
            
                <a href="../2 - Êìç‰ΩúÁ≥ªÁªü_ÊúçÂä°Âô®‰∏éÁΩëÁªú/4. CMake3ÂàÜÈíü‰∏äÊâã.html">
            
                    
                    4. CMake3ÂàÜÈíü‰∏äÊâã
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.9" data-path="../2 - Êìç‰ΩúÁ≥ªÁªü_ÊúçÂä°Âô®‰∏éÁΩëÁªú/4. Mac ‰∏ãÂÆâË£Ö OpenCV.html">
            
                <a href="../2 - Êìç‰ΩúÁ≥ªÁªü_ÊúçÂä°Âô®‰∏éÁΩëÁªú/4. Mac ‰∏ãÂÆâË£Ö OpenCV.html">
            
                    
                    4. Mac ‰∏ãÂÆâË£Ö OpenCV
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.10" data-path="../2 - Êìç‰ΩúÁ≥ªÁªü_ÊúçÂä°Âô®‰∏éÁΩëÁªú/ËΩØÁ°¨ÈìæÊé• ‰∏é Linux Êñá‰ª∂Á≥ªÁªü.html">
            
                <a href="../2 - Êìç‰ΩúÁ≥ªÁªü_ÊúçÂä°Âô®‰∏éÁΩëÁªú/ËΩØÁ°¨ÈìæÊé• ‰∏é Linux Êñá‰ª∂Á≥ªÁªü.html">
            
                    
                    ËΩØÁ°¨ÈìæÊé• ‰∏é Linux Êñá‰ª∂Á≥ªÁªü
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" >
            
                <span>
            
                    
                    3 - ÁéØÂ¢ÉÊê≠Âª∫_ÂºÄÂèëÊïàÁéá
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../3 - ÁéØÂ¢ÉÊê≠Âª∫_ÂºÄÂèëÊïàÁéá/2. Conda_ENV‰∏≠Ê≠£Á°Æ‰ΩøÁî®pip Install.html">
            
                <a href="../3 - ÁéØÂ¢ÉÊê≠Âª∫_ÂºÄÂèëÊïàÁéá/2. Conda_ENV‰∏≠Ê≠£Á°Æ‰ΩøÁî®pip Install.html">
            
                    
                    2. Conda_ENV‰∏≠Ê≠£Á°Æ‰ΩøÁî®pip Install
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../3 - ÁéØÂ¢ÉÊê≠Âª∫_ÂºÄÂèëÊïàÁéá/2. CondaÊ∑ªÂä†ÈïúÂÉè - Ëß£ÂÜ≥‰∏ãËΩΩËøáÊÖ¢.html">
            
                <a href="../3 - ÁéØÂ¢ÉÊê≠Âª∫_ÂºÄÂèëÊïàÁéá/2. CondaÊ∑ªÂä†ÈïúÂÉè - Ëß£ÂÜ≥‰∏ãËΩΩËøáÊÖ¢.html">
            
                    
                    2. CondaÊ∑ªÂä†ÈïúÂÉè - Ëß£ÂÜ≥‰∏ãËΩΩËøáÊÖ¢
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../3 - ÁéØÂ¢ÉÊê≠Âª∫_ÂºÄÂèëÊïàÁéá/2. Linux Á≥ªÁªü‰∏ã conda ÁöÑÂÆâË£Ö‰∏é‰ΩøÁî®.html">
            
                <a href="../3 - ÁéØÂ¢ÉÊê≠Âª∫_ÂºÄÂèëÊïàÁéá/2. Linux Á≥ªÁªü‰∏ã conda ÁöÑÂÆâË£Ö‰∏é‰ΩøÁî®.html">
            
                    
                    2. Linux Á≥ªÁªü‰∏ã conda ÁöÑÂÆâË£Ö‰∏é‰ΩøÁî®
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="../3 - ÁéØÂ¢ÉÊê≠Âª∫_ÂºÄÂèëÊïàÁéá/2. Mac ÂøÖÂ§áÁ•ûÂô® Homebrew.html">
            
                <a href="../3 - ÁéØÂ¢ÉÊê≠Âª∫_ÂºÄÂèëÊïàÁéá/2. Mac ÂøÖÂ§áÁ•ûÂô® Homebrew.html">
            
                    
                    2. Mac ÂøÖÂ§áÁ•ûÂô® Homebrew
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5" data-path="../3 - ÁéØÂ¢ÉÊê≠Âª∫_ÂºÄÂèëÊïàÁéá/3. VSCODE - Ëß£ÂÜ≥ vscode ‰∏≠‰ΩøÁî® pytorch Êó∂ pylint Êä•Èîô Module torch has no xxx member.html">
            
                <a href="../3 - ÁéØÂ¢ÉÊê≠Âª∫_ÂºÄÂèëÊïàÁéá/3. VSCODE - Ëß£ÂÜ≥ vscode ‰∏≠‰ΩøÁî® pytorch Êó∂ pylint Êä•Èîô Module torch has no xxx member.html">
            
                    
                    3. VSCODE - Ëß£ÂÜ≥ vscode ‰∏≠‰ΩøÁî® pytorch Êó∂ pylint Êä•Èîô Module torch has no xxx member
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.6" data-path="../3 - ÁéØÂ¢ÉÊê≠Âª∫_ÂºÄÂèëÊïàÁéá/‰ªãÁªç-JupyterÁΩëÁªúÁ¨îËÆ∞Êú¨.html">
            
                <a href="../3 - ÁéØÂ¢ÉÊê≠Âª∫_ÂºÄÂèëÊïàÁéá/‰ªãÁªç-JupyterÁΩëÁªúÁ¨îËÆ∞Êú¨.html">
            
                    
                    ‰ªãÁªç-JupyterÁΩëÁªúÁ¨îËÆ∞Êú¨
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" >
            
                <span>
            
                    
                    4 Python API
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../4 - Python_API/Language - Python.html">
            
                <a href="../4 - Python_API/Language - Python.html">
            
                    
                    Language Python
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../4 - Python_API/Lib - TensorFlow_API.html">
            
                <a href="../4 - Python_API/Lib - TensorFlow_API.html">
            
                    
                    Lib Tensor Flow API
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="../4 - Python_API/Python ‰∏≠ with Áî®Ê≥ïÂèäÂéüÁêÜ.html">
            
                <a href="../4 - Python_API/Python ‰∏≠ with Áî®Ê≥ïÂèäÂéüÁêÜ.html">
            
                    
                    Python ‰∏≠ with Áî®Ê≥ïÂèäÂéüÁêÜ
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4" data-path="../4 - Python_API/python ‰∏≠ÔºåËä±Êã¨Âè∑Ôºå‰∏≠Êã¨Âè∑ÔºåÂ∞èÊã¨Âè∑ÁöÑÂå∫Âà´.html">
            
                <a href="../4 - Python_API/python ‰∏≠ÔºåËä±Êã¨Âè∑Ôºå‰∏≠Êã¨Âè∑ÔºåÂ∞èÊã¨Âè∑ÁöÑÂå∫Âà´.html">
            
                    
                    python ‰∏≠ÔºåËä±Êã¨Âè∑Ôºå‰∏≠Êã¨Âè∑ÔºåÂ∞èÊã¨Âè∑ÁöÑÂå∫Âà´
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.5" data-path="../4 - Python_API/Python Âà§Êñ≠ÂàóË°®‰∏≠ÊòØÂê¶Â≠òÂú®ÊüêÂÖÉÁ¥†.html">
            
                <a href="../4 - Python_API/Python Âà§Êñ≠ÂàóË°®‰∏≠ÊòØÂê¶Â≠òÂú®ÊüêÂÖÉÁ¥†.html">
            
                    
                    Python Âà§Êñ≠ÂàóË°®‰∏≠ÊòØÂê¶Â≠òÂú®ÊüêÂÖÉÁ¥†
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.6" data-path="../4 - Python_API/python Ëé∑ÂèñÂΩìÂâçÂ∑•‰ΩúÁõÆÂΩï.html">
            
                <a href="../4 - Python_API/python Ëé∑ÂèñÂΩìÂâçÂ∑•‰ΩúÁõÆÂΩï.html">
            
                    
                    python Ëé∑ÂèñÂΩìÂâçÂ∑•‰ΩúÁõÆÂΩï
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.7" data-path="../4 - Python_API/python ËØªÂÜô csv Êñá‰ª∂ÔºàÂàõÂª∫ÔºåËøΩÂä†ÔºåË¶ÜÁõñÔºâ.html">
            
                <a href="../4 - Python_API/python ËØªÂÜô csv Êñá‰ª∂ÔºàÂàõÂª∫ÔºåËøΩÂä†ÔºåË¶ÜÁõñÔºâ.html">
            
                    
                    python ËØªÂÜô csv Êñá‰ª∂ÔºàÂàõÂª∫ÔºåËøΩÂä†ÔºåË¶ÜÁõñÔºâ
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.8" data-path="../4 - Python_API/python Ë∑ØÂæÑÊãºÊé• os.path.join(">
            
                <span>
            
                    
                    python Ë∑ØÂæÑÊãºÊé• os.path.join() ÂáΩÊï∞ÁöÑÁî®Ê≥ï
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.9" data-path="../4 - Python_API/python ÈÄêË°åËØªÂèñÊñá‰ª∂ÂÜÖÂÆπÁöÑ‰∏âÁßçÊñπÊ≥ï.html">
            
                <a href="../4 - Python_API/python ÈÄêË°åËØªÂèñÊñá‰ª∂ÂÜÖÂÆπÁöÑ‰∏âÁßçÊñπÊ≥ï.html">
            
                    
                    python ÈÄêË°åËØªÂèñÊñá‰ª∂ÂÜÖÂÆπÁöÑ‰∏âÁßçÊñπÊ≥ï
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.10" data-path="../4 - Python_API/Python3 rfind(">
            
                <span>
            
                    
                    Python3 rfind() ÊñπÊ≥ï
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.11" data-path="../4 - Python_API/pythonËØªÂÜô JSON Êï∞ÊçÆ.html">
            
                <a href="../4 - Python_API/pythonËØªÂÜô JSON Êï∞ÊçÆ.html">
            
                    
                    pythonËØªÂÜô JSON Êï∞ÊçÆ
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.12" data-path="../4 - Python_API/‰ΩøÁî® opencv ËøõË°åÁÆÄÂçïÁöÑÊä†Âõæ.html">
            
                <a href="../4 - Python_API/‰ΩøÁî® opencv ËøõË°åÁÆÄÂçïÁöÑÊä†Âõæ.html">
            
                    
                    ‰ΩøÁî® opencv ËøõË°åÁÆÄÂçïÁöÑÊä†Âõæ
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" >
            
                <span>
            
                    
                    5 - ÂÆûÈ™åÁ¨îËÆ∞
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" >
            
                <span>
            
                    
                    PytochËá™ÂÆö‰πâÁ±ªÊîπÂÜôÊï∞ÊçÆ
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1.1" data-path="PytochËá™ÂÆö‰πâÁ±ªÊîπÂÜôÊï∞ÊçÆ/Datasets & Dataloaders ‚Äî PyTorch Tutorials 1.8.1+cu102 documentation.html">
            
                <a href="PytochËá™ÂÆö‰πâÁ±ªÊîπÂÜôÊï∞ÊçÆ/Datasets & Dataloaders ‚Äî PyTorch Tutorials 1.8.1+cu102 documentation.html">
            
                    
                    Datasets & Dataloaders ‚Äî PyTorch Tutorials 1.8.1+cu102 documentation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.1.2" data-path="PytochËá™ÂÆö‰πâÁ±ªÊîπÂÜôÊï∞ÊçÆ/PyTorch ÊâãÊääÊâãËá™ÂÆö‰πâ Dataloader ËØªÂèñÊï∞ÊçÆ.html">
            
                <a href="PytochËá™ÂÆö‰πâÁ±ªÊîπÂÜôÊï∞ÊçÆ/PyTorch ÊâãÊääÊâãËá™ÂÆö‰πâ Dataloader ËØªÂèñÊï∞ÊçÆ.html">
            
                    
                    PyTorch ÊâãÊääÊâãËá™ÂÆö‰πâ Dataloader ËØªÂèñÊï∞ÊçÆ
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.1.3" data-path="PytochËá™ÂÆö‰πâÁ±ªÊîπÂÜôÊï∞ÊçÆ/Pytorch Ê∫êÁ†ÅËß£ËØª - torchvision.datasets.folder.html">
            
                <a href="PytochËá™ÂÆö‰πâÁ±ªÊîπÂÜôÊï∞ÊçÆ/Pytorch Ê∫êÁ†ÅËß£ËØª - torchvision.datasets.folder.html">
            
                    
                    Pytorch Ê∫êÁ†ÅËß£ËØª - torchvision.datasets.folder
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.1.4" data-path="PytochËá™ÂÆö‰πâÁ±ªÊîπÂÜôÊï∞ÊçÆ/torchvisionËá™ÂÆö‰πâÊï∞ÊçÆËØªÂèñ.html">
            
                <a href="PytochËá™ÂÆö‰πâÁ±ªÊîπÂÜôÊï∞ÊçÆ/torchvisionËá™ÂÆö‰πâÊï∞ÊçÆËØªÂèñ.html">
            
                    
                    torchvisionËá™ÂÆö‰πâÊï∞ÊçÆËØªÂèñ
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.1.5" data-path="PytochËá™ÂÆö‰πâÁ±ªÊîπÂÜôÊï∞ÊçÆ/Ëá™ÂÆö‰πâÊï∞ÊçÆËØªÂèñÊñπÂºè orch.utils.data.Dataset ‰∏é Dataloader.html">
            
                <a href="PytochËá™ÂÆö‰πâÁ±ªÊîπÂÜôÊï∞ÊçÆ/Ëá™ÂÆö‰πâÊï∞ÊçÆËØªÂèñÊñπÂºè orch.utils.data.Dataset ‰∏é Dataloader.html">
            
                    
                    Ëá™ÂÆö‰πâÊï∞ÊçÆËØªÂèñÊñπÂºè orch.utils.data.Dataset ‰∏é Dataloader
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7.2" >
            
                <span>
            
                    
                    Yolo Deepsort
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.2.1" data-path="Yolo+Deepsort/„ÄêÂ•ΩÊñáüò≠„ÄëÊâãÊääÊâãÊïô‰Ω†Áî® YOLOv5 ËÆ≠ÁªÉËá™Â∑±ÁöÑÊï∞ÊçÆÈõÜ.html">
            
                <a href="Yolo+Deepsort/„ÄêÂ•ΩÊñáüò≠„ÄëÊâãÊääÊâãÊïô‰Ω†Áî® YOLOv5 ËÆ≠ÁªÉËá™Â∑±ÁöÑÊï∞ÊçÆÈõÜ.html">
            
                    
                    „ÄêÂ•ΩÊñáüò≠„ÄëÊâãÊääÊâãÊïô‰Ω†Áî® YOLOv5 ËÆ≠ÁªÉËá™Â∑±ÁöÑÊï∞ÊçÆÈõÜ
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2.2" data-path="Yolo+Deepsort/„ÄêÁõÆÊ†áÊ£ÄÊµãÂÆûÊàò„ÄëDarknet‚Äîyolov3 Ê®°ÂûãËÆ≠ÁªÉÔºàVOC Êï∞ÊçÆÈõÜ">
            
                <span>
            
                    
                    „ÄêÁõÆÊ†áÊ£ÄÊµãÂÆûÊàò„ÄëDarknet‚Äîyolov3 Ê®°ÂûãËÆ≠ÁªÉÔºàVOC Êï∞ÊçÆÈõÜ)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2.3" data-path="Yolo+Deepsort/DeepSort - Âü∫‰∫é YOLOv5 Âíå DeepSort ÁöÑÁõÆÊ†áË∑üË∏™.html">
            
                <a href="Yolo+Deepsort/DeepSort - Âü∫‰∫é YOLOv5 Âíå DeepSort ÁöÑÁõÆÊ†áË∑üË∏™.html">
            
                    
                    DeepSort - Âü∫‰∫é YOLOv5 Âíå DeepSort ÁöÑÁõÆÊ†áË∑üË∏™
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2.4" data-path="Yolo+Deepsort/Market 1501 Êï∞ÊçÆÈõÜÂèäÂú® DeepSort ‰∏≠ÁöÑËÆ≠ÁªÉ.html">
            
                <a href="Yolo+Deepsort/Market 1501 Êï∞ÊçÆÈõÜÂèäÂú® DeepSort ‰∏≠ÁöÑËÆ≠ÁªÉ.html">
            
                    
                    Market 1501 Êï∞ÊçÆÈõÜÂèäÂú® DeepSort ‰∏≠ÁöÑËÆ≠ÁªÉ
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2.5" data-path="Yolo+Deepsort/yolov5 ÂêØÁî®Êï∞ÊçÆÂ¢ûÂº∫‰∏é tensorboard ÂèØËßÜÂåñ.html">
            
                <a href="Yolo+Deepsort/yolov5 ÂêØÁî®Êï∞ÊçÆÂ¢ûÂº∫‰∏é tensorboard ÂèØËßÜÂåñ.html">
            
                    
                    yolov5 ÂêØÁî®Êï∞ÊçÆÂ¢ûÂº∫‰∏é tensorboard ÂèØËßÜÂåñ
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2.6" data-path="Yolo+Deepsort/YOLOv5 ÁöÑËØ¶ÁªÜ‰ΩøÁî®ÊïôÁ®ãÔºå‰ª•Âèä‰ΩøÁî® yolov5 ËÆ≠ÁªÉËá™Â∑±ÁöÑÊï∞ÊçÆÈõÜ.html">
            
                <a href="Yolo+Deepsort/YOLOv5 ÁöÑËØ¶ÁªÜ‰ΩøÁî®ÊïôÁ®ãÔºå‰ª•Âèä‰ΩøÁî® yolov5 ËÆ≠ÁªÉËá™Â∑±ÁöÑÊï∞ÊçÆÈõÜ.html">
            
                    
                    YOLOv5 ÁöÑËØ¶ÁªÜ‰ΩøÁî®ÊïôÁ®ãÔºå‰ª•Âèä‰ΩøÁî® yolov5 ËÆ≠ÁªÉËá™Â∑±ÁöÑÊï∞ÊçÆÈõÜ
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2.7" data-path="Yolo+Deepsort/Yolov5_DeepSort_Pytorch ËÆ≠ÁªÉËá™Â∑±ÁöÑÊï∞ÊçÆ.html">
            
                <a href="Yolo+Deepsort/Yolov5_DeepSort_Pytorch ËÆ≠ÁªÉËá™Â∑±ÁöÑÊï∞ÊçÆ.html">
            
                    
                    Yolov5_DeepSort_Pytorch ËÆ≠ÁªÉËá™Â∑±ÁöÑÊï∞ÊçÆ
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7.3" >
            
                <span>
            
                    
                    YOLOÂÆûÈ™å
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.3.1" data-path="YOLOÂÆûÈ™å/Installing Darknet.html">
            
                <a href="YOLOÂÆûÈ™å/Installing Darknet.html">
            
                    
                    Installing Darknet
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.3.2" data-path="YOLOÂÆûÈ™å/YOLO: Real-Time Object Detection.html">
            
                <a href="YOLOÂÆûÈ™å/YOLO: Real-Time Object Detection.html">
            
                    
                    YOLO Real Time Object Detection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.3.3" data-path="YOLOÂÆûÈ™å/Âú® Linux ÊúçÂä°Âô®ÁéØÂ¢É‰∏ã‰ΩøÁî® yolov3 ËÆ≠ÁªÉ voc Êï∞ÊçÆÈõÜ.html">
            
                <a href="YOLOÂÆûÈ™å/Âú® Linux ÊúçÂä°Âô®ÁéØÂ¢É‰∏ã‰ΩøÁî® yolov3 ËÆ≠ÁªÉ voc Êï∞ÊçÆÈõÜ.html">
            
                    
                    Âú® Linux ÊúçÂä°Âô®ÁéØÂ¢É‰∏ã‰ΩøÁî® yolov3 ËÆ≠ÁªÉ voc Êï∞ÊçÆÈõÜ
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.3.4" data-path="YOLOÂÆûÈ™å/Âø´ÈÄüÂºÄÂßãScaledYOLOv4-Áü•‰πé.html">
            
                <a href="YOLOÂÆûÈ™å/Âø´ÈÄüÂºÄÂßãScaledYOLOv4-Áü•‰πé.html">
            
                    
                    Âø´ÈÄüÂºÄÂßãScaledYOLOv4-Áü•‰πé
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.3.5" data-path="YOLOÂÆûÈ™å/Á¨îËÆ∞ - Âú®ÊúçÂä°Âô®‰∏äÁî® YOLOv4 ËÆ≠ÁªÉÂíåÊµãËØïÊï∞ÊçÆÈõÜ.html">
            
                <a href="YOLOÂÆûÈ™å/Á¨îËÆ∞ - Âú®ÊúçÂä°Âô®‰∏äÁî® YOLOv4 ËÆ≠ÁªÉÂíåÊµãËØïÊï∞ÊçÆÈõÜ.html">
            
                    
                    Á¨îËÆ∞ - Âú®ÊúçÂä°Âô®‰∏äÁî® YOLOv4 ËÆ≠ÁªÉÂíåÊµãËØïÊï∞ÊçÆÈõÜ
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter active" data-level="1.7.4" data-path="üåüPytorch Êê≠Âª∫ YoloV4 ÁõÆÊ†áÊ£ÄÊµãÂπ≥Âè∞.html">
            
                <a href="üåüPytorch Êê≠Âª∫ YoloV4 ÁõÆÊ†áÊ£ÄÊµãÂπ≥Âè∞.html">
            
                    
                    üåüPytorch Êê≠Âª∫ YoloV4 ÁõÆÊ†áÊ£ÄÊµãÂπ≥Âè∞
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.5" data-path="yolo--- ÂèÇÊï∞Ëß£Èáä‰πã cfg Êñá‰ª∂ÂèÇÊï∞.html">
            
                <a href="yolo--- ÂèÇÊï∞Ëß£Èáä‰πã cfg Êñá‰ª∂ÂèÇÊï∞.html">
            
                    
                    yolo--- ÂèÇÊï∞Ëß£Èáä‰πã cfg Êñá‰ª∂ÂèÇÊï∞
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" >
            
                <span>
            
                    
                    6 - Êï∞Â≠óÁîüÊ¥ª
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="../6 - Êï∞Â≠óÁîüÊ¥ª/1. Ê∑±Â∫¶Â≠¶‰π†ÂõæÂÉèÊ†áÊ≥®Â∑•ÂÖ∑ - Labelme.html">
            
                <a href="../6 - Êï∞Â≠óÁîüÊ¥ª/1. Ê∑±Â∫¶Â≠¶‰π†ÂõæÂÉèÊ†áÊ≥®Â∑•ÂÖ∑ - Labelme.html">
            
                    
                    1. Ê∑±Â∫¶Â≠¶‰π†ÂõæÂÉèÊ†áÊ≥®Â∑•ÂÖ∑ - Labelme
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="../6 - Êï∞Â≠óÁîüÊ¥ª/Kindle‰ΩøÁî®ÊâãÂÜå.html">
            
                <a href="../6 - Êï∞Â≠óÁîüÊ¥ª/Kindle‰ΩøÁî®ÊâãÂÜå.html">
            
                    
                    Kindle‰ΩøÁî®ÊâãÂÜå
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3" data-path="../6 - Êï∞Â≠óÁîüÊ¥ª/Âç°Ë•øÊ¨ßgg1000ÊåáÈíàË∞ÉËäÇ.html">
            
                <a href="../6 - Êï∞Â≠óÁîüÊ¥ª/Âç°Ë•øÊ¨ßgg1000ÊåáÈíàË∞ÉËäÇ.html">
            
                    
                    Âç°Ë•øÊ¨ßgg1000ÊåáÈíàË∞ÉËäÇ
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >üåüPytorch Êê≠Âª∫ YoloV4 ÁõÆÊ†áÊ£ÄÊµãÂπ≥Âè∞</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <div id="anchor-navigation-ex-navbar"><i class="fa fa-navicon"></i><ul><ul><ul><li><span class="title-icon "></span><a href="#&#x777F;&#x667A;&#x7684;&#x76EE;&#x6807;&#x68C0;&#x6D4B;-30&#x2014;&#x2014;pytorch-&#x642D;&#x5EFA;-yolov4-&#x76EE;&#x6807;&#x68C0;&#x6D4B;&#x5E73;&#x53F0;"><b>1.1.1. </b>&#x777F;&#x667A;&#x7684;&#x76EE;&#x6807;&#x68C0;&#x6D4B; 30&#x2014;&#x2014;Pytorch &#x642D;&#x5EFA; YoloV4 &#x76EE;&#x6807;&#x68C0;&#x6D4B;&#x5E73;&#x53F0;</a></li></ul></ul><li><span class="title-icon "></span><a href="#&#x5B66;&#x4E60;&#x524D;&#x8A00;"><b>2. </b>&#x5B66;&#x4E60;&#x524D;&#x8A00;</a></li><li><span class="title-icon "></span><a href="#&#x4EC0;&#x4E48;&#x662F;-yolov4"><b>3. </b>&#x4EC0;&#x4E48;&#x662F; YOLOV4</a></li><li><span class="title-icon "></span><a href="#&#x4EE3;&#x7801;&#x4E0B;&#x8F7D;"><b>4. </b>&#x4EE3;&#x7801;&#x4E0B;&#x8F7D;</a></li><li><span class="title-icon "></span><a href="#yolov4-&#x6539;&#x8FDB;&#x7684;&#x90E8;&#x5206;&#xFF08;&#x4E0D;&#x5B8C;&#x5168;&#xFF09;"><b>5. </b>YOLOV4 &#x6539;&#x8FDB;&#x7684;&#x90E8;&#x5206;&#xFF08;&#x4E0D;&#x5B8C;&#x5168;&#xFF09;</a></li><li><span class="title-icon "></span><a href="#yolov4-&#x7ED3;&#x6784;&#x89E3;&#x6790;"><b>6. </b>YOLOV4 &#x7ED3;&#x6784;&#x89E3;&#x6790;</a></li><ul><li><span class="title-icon "></span><a href="#1&#x3001;&#x4E3B;&#x5E72;&#x7279;&#x5F81;&#x63D0;&#x53D6;&#x7F51;&#x7EDC;-backbone"><b>6.1. </b>1&#x3001;&#x4E3B;&#x5E72;&#x7279;&#x5F81;&#x63D0;&#x53D6;&#x7F51;&#x7EDC; Backbone</a></li><li><span class="title-icon "></span><a href="#2&#x3001;&#x7279;&#x5F81;&#x91D1;&#x5B57;&#x5854;"><b>6.2. </b>2&#x3001;&#x7279;&#x5F81;&#x91D1;&#x5B57;&#x5854;</a></li><li><span class="title-icon "></span><a href="#3&#x3001;yolohead-&#x5229;&#x7528;&#x83B7;&#x5F97;&#x5230;&#x7684;&#x7279;&#x5F81;&#x8FDB;&#x884C;&#x9884;&#x6D4B;"><b>6.3. </b>3&#x3001;YoloHead &#x5229;&#x7528;&#x83B7;&#x5F97;&#x5230;&#x7684;&#x7279;&#x5F81;&#x8FDB;&#x884C;&#x9884;&#x6D4B;</a></li><li><span class="title-icon "></span><a href="#4&#x3001;&#x9884;&#x6D4B;&#x7ED3;&#x679C;&#x7684;&#x89E3;&#x7801;"><b>6.4. </b>4&#x3001;&#x9884;&#x6D4B;&#x7ED3;&#x679C;&#x7684;&#x89E3;&#x7801;</a></li><li><span class="title-icon "></span><a href="#5&#x3001;&#x5728;&#x539F;&#x56FE;&#x4E0A;&#x8FDB;&#x884C;&#x7ED8;&#x5236;"><b>6.5. </b>5&#x3001;&#x5728;&#x539F;&#x56FE;&#x4E0A;&#x8FDB;&#x884C;&#x7ED8;&#x5236;</a></li></ul><li><span class="title-icon "></span><a href="#yolov4-&#x7684;&#x8BAD;&#x7EC3;"><b>7. </b>YOLOV4 &#x7684;&#x8BAD;&#x7EC3;</a></li><ul><li><span class="title-icon "></span><a href="#1&#x3001;yolov4-&#x7684;&#x6539;&#x8FDB;&#x8BAD;&#x7EC3;&#x6280;&#x5DE7;"><b>7.1. </b>1&#x3001;YOLOV4 &#x7684;&#x6539;&#x8FDB;&#x8BAD;&#x7EC3;&#x6280;&#x5DE7;</a></li><ul><li><span class="title-icon "></span><a href="#a&#x3001;mosaic-&#x6570;&#x636E;&#x589E;&#x5F3A;"><b>7.1.1. </b>a)&#x3001;Mosaic &#x6570;&#x636E;&#x589E;&#x5F3A;</a></li><li><span class="title-icon "></span><a href="#b&#x3001;label-smoothing-&#x5E73;&#x6ED1;"><b>7.1.2. </b>b)&#x3001;Label Smoothing &#x5E73;&#x6ED1;</a></li><li><span class="title-icon "></span><a href="#c&#x3001;ciou"><b>7.1.3. </b>c)&#x3001;CIOU</a></li><li><span class="title-icon "></span><a href="#d&#x3001;&#x5B66;&#x4E60;&#x7387;&#x4F59;&#x5F26;&#x9000;&#x706B;&#x8870;&#x51CF;"><b>7.1.4. </b>d)&#x3001;&#x5B66;&#x4E60;&#x7387;&#x4F59;&#x5F26;&#x9000;&#x706B;&#x8870;&#x51CF;</a></li></ul><li><span class="title-icon "></span><a href="#2&#x3001;loss-&#x7EC4;&#x6210;"><b>7.2. </b>2&#x3001;loss &#x7EC4;&#x6210;</a></li><ul><li><span class="title-icon "></span><a href="#a&#x3001;&#x8BA1;&#x7B97;-loss-&#x6240;&#x9700;&#x53C2;&#x6570;"><b>7.2.1. </b>a)&#x3001;&#x8BA1;&#x7B97; loss &#x6240;&#x9700;&#x53C2;&#x6570;</a></li><li><span class="title-icon "></span><a href="#b&#x3001;ypre-&#x662F;&#x4EC0;&#x4E48;"><b>7.2.2. </b>b)&#x3001;y_pre &#x662F;&#x4EC0;&#x4E48;</a></li><li><span class="title-icon "></span><a href="#c&#x3001;ytrue-&#x662F;&#x4EC0;&#x4E48;&#x3002;"><b>7.2.3. </b>c)&#x3001;y_true &#x662F;&#x4EC0;&#x4E48;&#x3002;</a></li><li><span class="title-icon "></span><a href="#d&#x3001;loss-&#x7684;&#x8BA1;&#x7B97;&#x8FC7;&#x7A0B;"><b>7.2.4. </b>d)&#x3001;loss &#x7684;&#x8BA1;&#x7B97;&#x8FC7;&#x7A0B;</a></li></ul></ul><li><span class="title-icon "></span><a href="#&#x8BAD;&#x7EC3;&#x81EA;&#x5DF1;&#x7684;-yolov4-&#x6A21;&#x578B;"><b>8. </b>&#x8BAD;&#x7EC3;&#x81EA;&#x5DF1;&#x7684; YOLOV4 &#x6A21;&#x578B;</a></li></ul></div><a href="#" id="anchorNavigationExGoTop"><i class="fa fa-arrow-up"></i></a><blockquote>
<p>&#x672C;&#x6587;&#x7531; <a href="http://ksria.com/simpread/" target="_blank">&#x7B80;&#x60A6; SimpRead</a> &#x8F6C;&#x7801;&#xFF0C; &#x539F;&#x6587;&#x5730;&#x5740; <a href="https://blog.csdn.net/weixin_44791964/article/details/106214657" target="_blank">blog.csdn.net</a></p>
</blockquote>
<h3 id="&#x777F;&#x667A;&#x7684;&#x76EE;&#x6807;&#x68C0;&#x6D4B;-30&#x2014;&#x2014;pytorch-&#x642D;&#x5EFA;-yolov4-&#x76EE;&#x6807;&#x68C0;&#x6D4B;&#x5E73;&#x53F0;"><a name="&#x777F;&#x667A;&#x7684;&#x76EE;&#x6807;&#x68C0;&#x6D4B;-30&#x2014;&#x2014;pytorch-&#x642D;&#x5EFA;-yolov4-&#x76EE;&#x6807;&#x68C0;&#x6D4B;&#x5E73;&#x53F0;" class="anchor-navigation-ex-anchor" href="#&#x777F;&#x667A;&#x7684;&#x76EE;&#x6807;&#x68C0;&#x6D4B;-30&#x2014;&#x2014;pytorch-&#x642D;&#x5EFA;-yolov4-&#x76EE;&#x6807;&#x68C0;&#x6D4B;&#x5E73;&#x53F0;"><i class="fa fa-link" aria-hidden="true"></i></a>1.1.1. &#x777F;&#x667A;&#x7684;&#x76EE;&#x6807;&#x68C0;&#x6D4B; 30&#x2014;&#x2014;Pytorch &#x642D;&#x5EFA; YoloV4 &#x76EE;&#x6807;&#x68C0;&#x6D4B;&#x5E73;&#x53F0;</h3>
<ul>
<li><a href="#_2">&#x5B66;&#x4E60;&#x524D;&#x8A00;</a></li>
<li><a href="#YOLOV4_5">&#x4EC0;&#x4E48;&#x662F; YOLOV4</a></li>
<li><a href="#_25">&#x4EE3;&#x7801;&#x4E0B;&#x8F7D;</a></li>
<li><a href="#YOLOV4_28">YOLOV4 &#x6539;&#x8FDB;&#x7684;&#x90E8;&#x5206;&#xFF08;&#x4E0D;&#x5B8C;&#x5168;&#xFF09;</a></li>
<li><a href="#YOLOV4_48">YOLOV4 &#x7ED3;&#x6784;&#x89E3;&#x6790;</a></li>
<li><ul>
<li><a href="#1Backbone_52">1&#x3001;&#x4E3B;&#x5E72;&#x7279;&#x5F81;&#x63D0;&#x53D6;&#x7F51;&#x7EDC; Backbone</a></li>
<li><a href="#2_264">2&#x3001;&#x7279;&#x5F81;&#x91D1;&#x5B57;&#x5854;</a></li>
<li><a href="#3YoloHead_373">3&#x3001;YoloHead &#x5229;&#x7528;&#x83B7;&#x5F97;&#x5230;&#x7684;&#x7279;&#x5F81;&#x8FDB;&#x884C;&#x9884;&#x6D4B;</a></li>
<li><a href="#4_466">4&#x3001;&#x9884;&#x6D4B;&#x7ED3;&#x679C;&#x7684;&#x89E3;&#x7801;</a></li>
<li><a href="#5_560">5&#x3001;&#x5728;&#x539F;&#x56FE;&#x4E0A;&#x8FDB;&#x884C;&#x7ED8;&#x5236;</a></li>
</ul>
</li>
<li><a href="#YOLOV4_563">YOLOV4 &#x7684;&#x8BAD;&#x7EC3;</a></li>
<li><ul>
<li><a href="#1YOLOV4_564">1&#x3001;YOLOV4 &#x7684;&#x6539;&#x8FDB;&#x8BAD;&#x7EC3;&#x6280;&#x5DE7;</a></li>
<li><ul>
<li><a href="#aMosaic_565">a)&#x3001;Mosaic &#x6570;&#x636E;&#x589E;&#x5F3A;</a></li>
<li><a href="#bLabel_Smoothing_771">b)&#x3001;Label Smoothing &#x5E73;&#x6ED1;</a></li>
<li><a href="#cCIOU_790">c)&#x3001;CIOU</a></li>
<li><a href="#d_866">d)&#x3001;&#x5B66;&#x4E60;&#x7387;&#x4F59;&#x5F26;&#x9000;&#x706B;&#x8870;&#x51CF;</a></li>
</ul>
</li>
<li><a href="#2loss_877">2&#x3001;loss &#x7EC4;&#x6210;</a></li>
<li><ul>
<li><a href="#aloss_878">a)&#x3001;&#x8BA1;&#x7B97; loss &#x6240;&#x9700;&#x53C2;&#x6570;</a></li>
<li><a href="#by_pre_886">b)&#x3001;y_pre &#x662F;&#x4EC0;&#x4E48;</a></li>
<li><a href="#cy_true_890">c)&#x3001;y_true &#x662F;&#x4EC0;&#x4E48;&#x3002;</a></li>
<li><a href="#dloss_892">d)&#x3001;loss &#x7684;&#x8BA1;&#x7B97;&#x8FC7;&#x7A0B;</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#YOLOV4_1175">&#x8BAD;&#x7EC3;&#x81EA;&#x5DF1;&#x7684; YOLOV4 &#x6A21;&#x578B;</a></li>
</ul>
<h1 id="&#x5B66;&#x4E60;&#x524D;&#x8A00;"><a name="&#x5B66;&#x4E60;&#x524D;&#x8A00;" class="anchor-navigation-ex-anchor" href="#&#x5B66;&#x4E60;&#x524D;&#x8A00;"><i class="fa fa-link" aria-hidden="true"></i></a>2. &#x5B66;&#x4E60;&#x524D;&#x8A00;</h1>
<p>&#x4E5F;&#x505A;&#x4E86;&#x4E00;&#x4E0B; pytorch &#x7248;&#x672C;&#x7684;&#x3002;<br><img src="https://img-blog.csdnimg.cn/20190723165901974.jpg#pic_center" alt=""></p>
<h1 id="&#x4EC0;&#x4E48;&#x662F;-yolov4"><a name="&#x4EC0;&#x4E48;&#x662F;-yolov4" class="anchor-navigation-ex-anchor" href="#&#x4EC0;&#x4E48;&#x662F;-yolov4"><i class="fa fa-link" aria-hidden="true"></i></a>3. &#x4EC0;&#x4E48;&#x662F; YOLOV4</h1>
<p><img src="https://img-blog.csdnimg.cn/20200509111027627.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDc5MTk2NA==,size_16,color_FFFFFF,t_70#pic_center" alt=""><br>YOLOV4 &#x662F; YOLOV3 &#x7684;&#x6539;&#x8FDB;&#x7248;&#xFF0C;<strong>&#x5728; YOLOV3 &#x7684;&#x57FA;&#x7840;&#x4E0A;&#x7ED3;&#x5408;&#x4E86;&#x975E;&#x5E38;&#x591A;&#x7684;&#x5C0F; Tricks&#x3002;</strong><br>&#x5C3D;&#x7BA1;&#x6CA1;&#x6709;&#x76EE;&#x6807;&#x68C0;&#x6D4B;&#x4E0A;&#x9769;&#x547D;&#x6027;&#x7684;&#x6539;&#x53D8;&#xFF0C;&#x4F46;&#x662F; YOLOV4 &#x4F9D;&#x7136;&#x5F88;&#x597D;&#x7684;&#x7ED3;&#x5408;&#x4E86;&#x901F;&#x5EA6;&#x4E0E;&#x7CBE;&#x5EA6;&#x3002;<br>&#x6839;&#x636E;&#x4E0A;&#x56FE;&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#x6765;&#xFF0C;<strong>YOLOV4 &#x5728; YOLOV3 &#x7684;&#x57FA;&#x7840;&#x4E0A;&#xFF0C;&#x5728; FPS &#x4E0D;&#x4E0B;&#x964D;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;mAP &#x8FBE;&#x5230;&#x4E86; 44&#xFF0C;&#x63D0;&#x9AD8;&#x975E;&#x5E38;&#x660E;&#x663E;&#x3002;</strong></p>
<p>YOLOV4 &#x6574;&#x4F53;&#x4E0A;&#x7684;&#x68C0;&#x6D4B;&#x601D;&#x8DEF;&#x548C; YOLOV3 &#x76F8;&#x6BD4;&#x76F8;&#x5DEE;&#x5E76;&#x4E0D;&#x5927;&#xFF0C;&#x90FD;&#x662F;&#x4F7F;&#x7528;&#x4E09;&#x4E2A;&#x7279;&#x5F81;&#x5C42;&#x8FDB;&#x884C;&#x5206;&#x7C7B;&#x4E0E;&#x56DE;&#x5F52;&#x9884;&#x6D4B;&#x3002;</p>
<p><strong>&#x8BF7;&#x6CE8;&#x610F;&#xFF01;</strong></p>
<p><strong>&#x5F3A;&#x70C8;&#x5EFA;&#x8BAE;&#x5728;&#x5B66;&#x4E60; YOLOV4 &#x4E4B;&#x524D;&#x5B66;&#x4E60; YOLOV3&#xFF0C;&#x56E0;&#x4E3A; YOLOV4 &#x786E;&#x5B9E;&#x53EF;&#x4EE5;&#x770B;&#x4F5C;&#x662F; YOLOV3 &#x7ED3;&#x5408;&#x4E00;&#x7CFB;&#x5217;&#x6539;&#x8FDB;&#x7684;&#x7248;&#x672C;&#xFF01;</strong></p>
<p><strong>&#x5F3A;&#x70C8;&#x5EFA;&#x8BAE;&#x5728;&#x5B66;&#x4E60; YOLOV4 &#x4E4B;&#x524D;&#x5B66;&#x4E60; YOLOV3&#xFF0C;&#x56E0;&#x4E3A; YOLOV4 &#x786E;&#x5B9E;&#x53EF;&#x4EE5;&#x770B;&#x4F5C;&#x662F; YOLOV3 &#x7ED3;&#x5408;&#x4E00;&#x7CFB;&#x5217;&#x6539;&#x8FDB;&#x7684;&#x7248;&#x672C;&#xFF01;</strong></p>
<p><strong>&#x5F3A;&#x70C8;&#x5EFA;&#x8BAE;&#x5728;&#x5B66;&#x4E60; YOLOV4 &#x4E4B;&#x524D;&#x5B66;&#x4E60; YOLOV3&#xFF0C;&#x56E0;&#x4E3A; YOLOV4 &#x786E;&#x5B9E;&#x53EF;&#x4EE5;&#x770B;&#x4F5C;&#x662F; YOLOV3 &#x7ED3;&#x5408;&#x4E00;&#x7CFB;&#x5217;&#x6539;&#x8FDB;&#x7684;&#x7248;&#x672C;&#xFF01;</strong></p>
<p>&#xFF08;&#x91CD;&#x8981;&#x7684;&#x4E8B;&#x60C5;&#x8BF4;&#x4E09;&#x904D;&#xFF01;&#xFF09;</p>
<p>YOLOV3 &#x53EF;&#x53C2;&#x8003;&#x8BE5;&#x535A;&#x5BA2;&#xFF1A;<br><a href="https://blog.csdn.net/weixin_44791964/article/details/105310627" target="_blank">https://blog.csdn.net/weixin_44791964/article/details/105310627</a></p>
<h1 id="&#x4EE3;&#x7801;&#x4E0B;&#x8F7D;"><a name="&#x4EE3;&#x7801;&#x4E0B;&#x8F7D;" class="anchor-navigation-ex-anchor" href="#&#x4EE3;&#x7801;&#x4E0B;&#x8F7D;"><i class="fa fa-link" aria-hidden="true"></i></a>4. &#x4EE3;&#x7801;&#x4E0B;&#x8F7D;</h1>
<p><a href="https://github.com/bubbliiiing/yolov4-pytorch" target="_blank">https://github.com/bubbliiiing/yolov4-pytorch</a><br>&#x559C;&#x6B22;&#x7684;&#x53EF;&#x4EE5;&#x7ED9;&#x4E2A; star &#x5662;&#xFF01;</p>
<h1 id="yolov4-&#x6539;&#x8FDB;&#x7684;&#x90E8;&#x5206;&#xFF08;&#x4E0D;&#x5B8C;&#x5168;&#xFF09;"><a name="yolov4-&#x6539;&#x8FDB;&#x7684;&#x90E8;&#x5206;&#xFF08;&#x4E0D;&#x5B8C;&#x5168;&#xFF09;" class="anchor-navigation-ex-anchor" href="#yolov4-&#x6539;&#x8FDB;&#x7684;&#x90E8;&#x5206;&#xFF08;&#x4E0D;&#x5B8C;&#x5168;&#xFF09;"><i class="fa fa-link" aria-hidden="true"></i></a>5. YOLOV4 &#x6539;&#x8FDB;&#x7684;&#x90E8;&#x5206;&#xFF08;&#x4E0D;&#x5B8C;&#x5168;&#xFF09;</h1>
<p><strong>1&#x3001;&#x4E3B;&#x5E72;&#x7279;&#x5F81;&#x63D0;&#x53D6;&#x7F51;&#x7EDC;&#xFF1A;DarkNet53 =&gt; CSPDarkNet53</strong></p>
<p><strong>2&#x3001;&#x7279;&#x5F81;&#x91D1;&#x5B57;&#x5854;&#xFF1A;SPP&#xFF0C;PAN</strong></p>
<p><strong>3&#x3001;&#x5206;&#x7C7B;&#x56DE;&#x5F52;&#x5C42;&#xFF1A;YOLOv3&#xFF08;&#x672A;&#x6539;&#x53D8;&#xFF09;</strong></p>
<p><strong>4&#x3001;&#x8BAD;&#x7EC3;&#x7528;&#x5230;&#x7684;&#x5C0F;&#x6280;&#x5DE7;&#xFF1A;Mosaic &#x6570;&#x636E;&#x589E;&#x5F3A;&#x3001;Label Smoothing &#x5E73;&#x6ED1;&#x3001;CIOU&#x3001;&#x5B66;&#x4E60;&#x7387;&#x4F59;&#x5F26;&#x9000;&#x706B;&#x8870;&#x51CF;</strong></p>
<p><strong>5&#x3001;&#x6FC0;&#x6D3B;&#x51FD;&#x6570;&#xFF1A;&#x4F7F;&#x7528; Mish &#x6FC0;&#x6D3B;&#x51FD;&#x6570;</strong></p>
<p><strong>&#x4EE5;&#x4E0A;&#x5E76;&#x975E;&#x5168;&#x90E8;&#x7684;&#x6539;&#x8FDB;&#x90E8;&#x5206;&#xFF0C;&#x8FD8;&#x5B58;&#x5728;&#x4E00;&#x4E9B;&#x5176;&#x5B83;&#x7684;&#x6539;&#x8FDB;&#xFF0C;&#x7531;&#x4E8E; YOLOV4 &#x4F7F;&#x7528;&#x7684;&#x6539;&#x8FDB;&#x5B9E;&#x5728;&#x592A;&#x591A;&#x4E86;&#xFF0C;&#x5F88;&#x96BE;&#x5B8C;&#x5168;&#x5B9E;&#x73B0;&#x4E0E;&#x5217;&#x51FA;&#x6765;&#xFF0C;&#x8FD9;&#x91CC;&#x53EA;&#x5217;&#x51FA;&#x6765;&#x4E86;&#x4E00;&#x4E9B;&#x6211;&#x6BD4;&#x8F83;&#x611F;&#x5174;&#x8DA3;&#xFF0C;&#x800C;&#x4E14;&#x975E;&#x5E38;&#x6709;&#x6548;&#x7684;&#x6539;&#x8FDB;&#x3002;</strong></p>
<p>&#x8FD8;&#x6709;&#x4E00;&#x4E2A;&#x91CD;&#x8981;&#x7684;&#x4E8B;&#x60C5;&#xFF1A;<br><strong>&#x8BBA;&#x6587;&#x4E2D;&#x63D0;&#x5230;&#x7684; SAM&#xFF0C;&#x4F5C;&#x8005;&#x81EA;&#x5DF1;&#x7684;&#x6E90;&#x7801;&#x4E5F;&#x6CA1;&#x6709;&#x4F7F;&#x7528;&#x3002;</strong></p>
<p><strong>&#x8FD8;&#x6709;&#x5176;&#x5B83;&#x5F88;&#x591A;&#x7684; tricks&#xFF0C;&#x4E0D;&#x662F;&#x6240;&#x6709;&#x7684; tricks &#x90FD;&#x6709;&#x63D0;&#x5347;&#xFF0C;&#x6211;&#x4E5F;&#x6CA1;&#x6CD5;&#x5B9E;&#x73B0;&#x5168;&#x90E8;&#x7684; tricks</strong>&#x3002;</p>
<p>&#x6574;&#x7BC7; BLOG &#x4F1A;&#x7ED3;&#x5408; YOLOV3 &#x4E0E; YOLOV4 &#x7684;&#x5DEE;&#x522B;&#x8FDB;&#x884C;&#x89E3;&#x6790;</p>
<h1 id="yolov4-&#x7ED3;&#x6784;&#x89E3;&#x6790;"><a name="yolov4-&#x7ED3;&#x6784;&#x89E3;&#x6790;" class="anchor-navigation-ex-anchor" href="#yolov4-&#x7ED3;&#x6784;&#x89E3;&#x6790;"><i class="fa fa-link" aria-hidden="true"></i></a>6. YOLOV4 &#x7ED3;&#x6784;&#x89E3;&#x6790;</h1>
<p><strong>&#x4E3A;&#x65B9;&#x4FBF;&#x7406;&#x89E3;&#xFF0C;&#x672C;&#x6587;&#x5C06;&#x6240;&#x6709;&#x901A;&#x9053;&#x6570;&#x90FD;&#x653E;&#x5230;&#x4E86;&#x6700;&#x540E;&#x4E00;&#x7EF4;&#x5EA6;&#x3002;<br>&#x4E3A;&#x65B9;&#x4FBF;&#x7406;&#x89E3;&#xFF0C;&#x672C;&#x6587;&#x5C06;&#x6240;&#x6709;&#x901A;&#x9053;&#x6570;&#x90FD;&#x653E;&#x5230;&#x4E86;&#x6700;&#x540E;&#x4E00;&#x7EF4;&#x5EA6;&#x3002;<br>&#x4E3A;&#x65B9;&#x4FBF;&#x7406;&#x89E3;&#xFF0C;&#x672C;&#x6587;&#x5C06;&#x6240;&#x6709;&#x901A;&#x9053;&#x6570;&#x90FD;&#x653E;&#x5230;&#x4E86;&#x6700;&#x540E;&#x4E00;&#x7EF4;&#x5EA6;&#x3002;</strong></p>
<h2 id="1&#x3001;&#x4E3B;&#x5E72;&#x7279;&#x5F81;&#x63D0;&#x53D6;&#x7F51;&#x7EDC;-backbone"><a name="1&#x3001;&#x4E3B;&#x5E72;&#x7279;&#x5F81;&#x63D0;&#x53D6;&#x7F51;&#x7EDC;-backbone" class="anchor-navigation-ex-anchor" href="#1&#x3001;&#x4E3B;&#x5E72;&#x7279;&#x5F81;&#x63D0;&#x53D6;&#x7F51;&#x7EDC;-backbone"><i class="fa fa-link" aria-hidden="true"></i></a>6.1. 1&#x3001;&#x4E3B;&#x5E72;&#x7279;&#x5F81;&#x63D0;&#x53D6;&#x7F51;&#x7EDC; Backbone</h2>
<p>&#x5F53;&#x8F93;&#x5165;&#x662F; 416x416 &#x65F6;&#xFF0C;&#x7279;&#x5F81;&#x7ED3;&#x6784;&#x5982;&#x4E0B;&#xFF1A;<br><img src="https://img-blog.csdnimg.cn/20200512144007178.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDc5MTk2NA==,size_16,color_FFFFFF,t_70#pic_center" alt=""><br>&#x5F53;&#x8F93;&#x5165;&#x662F; 608x608 &#x65F6;&#xFF0C;&#x7279;&#x5F81;&#x7ED3;&#x6784;&#x5982;&#x4E0B;&#xFF1A;<br><img src="https://img-blog.csdnimg.cn/20200509213429592.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDc5MTk2NA==,size_16,color_FFFFFF,t_70#pic_center" alt=""><br>&#x4E3B;&#x5E72;&#x7279;&#x5F81;&#x63D0;&#x53D6;&#x7F51;&#x7EDC; Backbone &#x7684;&#x6539;&#x8FDB;&#x70B9;&#x6709;&#x4E24;&#x4E2A;&#xFF1A;<br><strong>a). &#x4E3B;&#x5E72;&#x7279;&#x5F81;&#x63D0;&#x53D6;&#x7F51;&#x7EDC;&#xFF1A;DarkNet53 =&gt; CSPDarkNet53<br>b). &#x6FC0;&#x6D3B;&#x51FD;&#x6570;&#xFF1A;&#x4F7F;&#x7528; Mish &#x6FC0;&#x6D3B;&#x51FD;&#x6570;</strong></p>
<p>&#x5982;&#x679C;&#x5927;&#x5BB6;&#x5BF9; YOLOV3 &#x6BD4;&#x8F83;&#x719F;&#x6089;&#x7684;&#x8BDD;&#xFF0C;&#x5E94;&#x8BE5;&#x77E5;&#x9053; Darknet53 &#x7684;&#x7ED3;&#x6784;&#xFF0C;&#x5176;&#x7531;&#x4E00;&#x7CFB;&#x5217;&#x6B8B;&#x5DEE;&#x7F51;&#x7EDC;&#x7ED3;&#x6784;&#x6784;&#x6210;&#x3002;&#x5728; Darknet53 &#x4E2D;&#xFF0C;&#x5176;&#x5B58;&#x5728; <strong>resblock_body &#x6A21;&#x5757;</strong>&#xFF0C;&#x5176;&#x7531;&#x4E00;&#x6B21;<strong>&#x4E0B;&#x91C7;&#x6837;</strong>&#x548C;<strong>&#x591A;&#x6B21;&#x6B8B;&#x5DEE;&#x7ED3;&#x6784;&#x7684;&#x5806;&#x53E0;</strong>&#x6784;&#x6210;&#xFF0C;Darknet53 &#x4FBF;&#x662F;&#x7531; <strong>resblock_body &#x6A21;&#x5757;&#x7EC4;&#x5408;&#x800C;&#x6210;</strong>&#x3002;</p>
<p>&#x800C;&#x5728; YOLOV4 &#x4E2D;&#xFF0C;&#x5176;&#x5BF9;&#x8BE5;&#x90E8;&#x5206;&#x8FDB;&#x884C;&#x4E86;&#x4E00;&#x5B9A;&#x7684;&#x4FEE;&#x6539;&#x3002;<br>1&#x3001;&#x5176;&#x4E00;&#x662F;<strong>&#x5C06; DarknetConv2D &#x7684;&#x6FC0;&#x6D3B;&#x51FD;&#x6570;&#x7531; LeakyReLU &#x4FEE;&#x6539;&#x6210;&#x4E86; Mish</strong>&#xFF0C;&#x5377;&#x79EF;&#x5757;&#x7531; <strong>DarknetConv2D_BN_Leaky &#x53D8;&#x6210;&#x4E86; DarknetConv2D_BN_Mish</strong>&#x3002;<br>Mish &#x51FD;&#x6570;&#x7684;&#x516C;&#x5F0F;&#x4E0E;&#x56FE;&#x50CF;&#x5982;&#x4E0B;&#xFF1A;<br>M i s h = x &#xD7; t a n h ( l n ( 1 + e x ) ) Mish=x \times tanh(ln(1+e^x)) Mish=x&#xD7;tanh(ln(1+ex))<br><img src="https://img-blog.csdnimg.cn/20200509115101964.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDc5MTk2NA==,size_16,color_FFFFFF,t_70#pic_center" alt=""><br>2&#x3001;&#x5176;&#x4E8C;&#x662F;&#x5C06; resblock_body &#x7684;&#x7ED3;&#x6784;&#x8FDB;&#x884C;&#x4FEE;&#x6539;&#xFF0C;<strong>&#x4F7F;&#x7528;&#x4E86; CSPnet &#x7ED3;&#x6784;&#x3002;&#x6B64;&#x65F6; YOLOV4 &#x5F53;&#x4E2D;&#x7684; Darknet53 &#x88AB;&#x4FEE;&#x6539;&#x6210;&#x4E86; CSPDarknet53</strong>&#x3002;<br><img src="https://img-blog.csdnimg.cn/20200509113651540.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDc5MTk2NA==,size_16,color_FFFFFF,t_70#pic_center" alt=""><br>CSPnet &#x7ED3;&#x6784;&#x5E76;&#x4E0D;&#x7B97;&#x590D;&#x6742;&#xFF0C;&#x5C31;&#x662F;&#x5C06;&#x539F;&#x6765;&#x7684;&#x6B8B;&#x5DEE;&#x5757;&#x7684;&#x5806;&#x53E0;&#x8FDB;&#x884C;&#x4E86;&#x4E00;&#x4E2A;&#x62C6;&#x5206;&#xFF0C;&#x62C6;&#x6210;&#x5DE6;&#x53F3;&#x4E24;&#x90E8;&#x5206;&#xFF1A;<br><strong>&#x4E3B;&#x5E72;&#x90E8;&#x5206;&#x7EE7;&#x7EED;&#x8FDB;&#x884C;&#x539F;&#x6765;&#x7684;&#x6B8B;&#x5DEE;&#x5757;&#x7684;&#x5806;&#x53E0;</strong>&#xFF1B;<br><strong>&#x53E6;&#x4E00;&#x90E8;&#x5206;&#x5219;&#x50CF;&#x4E00;&#x4E2A;&#x6B8B;&#x5DEE;&#x8FB9;&#x4E00;&#x6837;&#xFF0C;&#x7ECF;&#x8FC7;&#x5C11;&#x91CF;&#x5904;&#x7406;&#x76F4;&#x63A5;&#x8FDE;&#x63A5;&#x5230;&#x6700;&#x540E;&#x3002;</strong><br>&#x56E0;&#x6B64;&#x53EF;&#x4EE5;&#x8BA4;&#x4E3A; <strong>CSP &#x4E2D;&#x5B58;&#x5728;&#x4E00;&#x4E2A;&#x5927;&#x7684;&#x6B8B;&#x5DEE;&#x8FB9;&#x3002;</strong></p>
<pre><code>#---------------------------------------------------#
#   CSPdarknet&#x7684;&#x7ED3;&#x6784;&#x5757;
#   &#x5B58;&#x5728;&#x4E00;&#x4E2A;&#x5927;&#x6B8B;&#x5DEE;&#x8FB9;
#   &#x8FD9;&#x4E2A;&#x5927;&#x6B8B;&#x5DEE;&#x8FB9;&#x7ED5;&#x8FC7;&#x4E86;&#x5F88;&#x591A;&#x7684;&#x6B8B;&#x5DEE;&#x7ED3;&#x6784;
#---------------------------------------------------#
class Resblock_body(nn.Module):
    def __init__(self, in_channels, out_channels, num_blocks, first):
        super(Resblock_body, self).__init__()

        self.downsample_conv = BasicConv(in_channels, out_channels, 3, stride=2)

        if first:
            self.split_conv0 = BasicConv(out_channels, out_channels, 1)
            self.split_conv1 = BasicConv(out_channels, out_channels, 1)  
            self.blocks_conv = nn.Sequential(
                Resblock(channels=out_channels, hidden_channels=out_channels//2),
                BasicConv(out_channels, out_channels, 1)
            )
            self.concat_conv = BasicConv(out_channels*2, out_channels, 1)
        else:
            self.split_conv0 = BasicConv(out_channels, out_channels//2, 1)
            self.split_conv1 = BasicConv(out_channels, out_channels//2, 1)

            self.blocks_conv = nn.Sequential(
                *[Resblock(out_channels//2) for _ in range(num_blocks)],
                BasicConv(out_channels//2, out_channels//2, 1)
            )
            self.concat_conv = BasicConv(out_channels, out_channels, 1)

    def forward(self, x):
        x = self.downsample_conv(x)

        x0 = self.split_conv0(x)

        x1 = self.split_conv1(x)
        x1 = self.blocks_conv(x1)

        x = torch.cat([x1, x0], dim=1)
        x = self.concat_conv(x)

        return x
</code></pre><p>&#x5168;&#x90E8;&#x5B9E;&#x73B0;&#x4EE3;&#x7801;&#x4E3A;&#xFF1A;</p>
<pre><code>import torch
import torch.nn.functional as F
import torch.nn as nn
import math
from collections import OrderedDict

#-------------------------------------------------#
#   MISH&#x6FC0;&#x6D3B;&#x51FD;&#x6570;
#-------------------------------------------------#
class Mish(nn.Module):
    def __init__(self):
        super(Mish, self).__init__()

    def forward(self, x):
        return x * torch.tanh(F.softplus(x))

#-------------------------------------------------#
#   &#x5377;&#x79EF;&#x5757;
#   CONV+BATCHNORM+MISH
#-------------------------------------------------#
class BasicConv(nn.Module):
    def __init__(self, in_channels, out_channels, kernel_size, stride=1):
        super(BasicConv, self).__init__()

        self.conv = nn.Conv2d(in_channels, out_channels, kernel_size, stride, kernel_size//2, bias=False)
        self.bn = nn.BatchNorm2d(out_channels)
        self.activation = Mish()

    def forward(self, x):
        x = self.conv(x)
        x = self.bn(x)
        x = self.activation(x)
        return x

#---------------------------------------------------#
#   CSPdarknet&#x7684;&#x7ED3;&#x6784;&#x5757;&#x7684;&#x7EC4;&#x6210;&#x90E8;&#x5206;
#   &#x5185;&#x90E8;&#x5806;&#x53E0;&#x7684;&#x6B8B;&#x5DEE;&#x5757;
#---------------------------------------------------#
class Resblock(nn.Module):
    def __init__(self, channels, hidden_channels=None, residual_activation=nn.Identity()):
        super(Resblock, self).__init__()

        if hidden_channels is None:
            hidden_channels = channels

        self.block = nn.Sequential(
            BasicConv(channels, hidden_channels, 1),
            BasicConv(hidden_channels, channels, 3)
        )

    def forward(self, x):
        return x+self.block(x)

#---------------------------------------------------#
#   CSPdarknet&#x7684;&#x7ED3;&#x6784;&#x5757;
#   &#x5B58;&#x5728;&#x4E00;&#x4E2A;&#x5927;&#x6B8B;&#x5DEE;&#x8FB9;
#   &#x8FD9;&#x4E2A;&#x5927;&#x6B8B;&#x5DEE;&#x8FB9;&#x7ED5;&#x8FC7;&#x4E86;&#x5F88;&#x591A;&#x7684;&#x6B8B;&#x5DEE;&#x7ED3;&#x6784;
#---------------------------------------------------#
class Resblock_body(nn.Module):
    def __init__(self, in_channels, out_channels, num_blocks, first):
        super(Resblock_body, self).__init__()

        self.downsample_conv = BasicConv(in_channels, out_channels, 3, stride=2)

        if first:
            self.split_conv0 = BasicConv(out_channels, out_channels, 1)
            self.split_conv1 = BasicConv(out_channels, out_channels, 1)  
            self.blocks_conv = nn.Sequential(
                Resblock(channels=out_channels, hidden_channels=out_channels//2),
                BasicConv(out_channels, out_channels, 1)
            )
            self.concat_conv = BasicConv(out_channels*2, out_channels, 1)
        else:
            self.split_conv0 = BasicConv(out_channels, out_channels//2, 1)
            self.split_conv1 = BasicConv(out_channels, out_channels//2, 1)

            self.blocks_conv = nn.Sequential(
                *[Resblock(out_channels//2) for _ in range(num_blocks)],
                BasicConv(out_channels//2, out_channels//2, 1)
            )
            self.concat_conv = BasicConv(out_channels, out_channels, 1)

    def forward(self, x):
        x = self.downsample_conv(x)

        x0 = self.split_conv0(x)

        x1 = self.split_conv1(x)
        x1 = self.blocks_conv(x1)

        x = torch.cat([x1, x0], dim=1)
        x = self.concat_conv(x)

        return x

class CSPDarkNet(nn.Module):
    def __init__(self, layers):
        super(CSPDarkNet, self).__init__()
        self.inplanes = 32
        self.conv1 = BasicConv(3, self.inplanes, kernel_size=3, stride=1)
        self.feature_channels = [64, 128, 256, 512, 1024]

        self.stages = nn.ModuleList([
            Resblock_body(self.inplanes, self.feature_channels[0], layers[0], first=True),
            Resblock_body(self.feature_channels[0], self.feature_channels[1], layers[1], first=False),
            Resblock_body(self.feature_channels[1], self.feature_channels[2], layers[2], first=False),
            Resblock_body(self.feature_channels[2], self.feature_channels[3], layers[3], first=False),
            Resblock_body(self.feature_channels[3], self.feature_channels[4], layers[4], first=False)
        ])

        self.num_features = 1
        # &#x8FDB;&#x884C;&#x6743;&#x503C;&#x521D;&#x59CB;&#x5316;
        for m in self.modules():
            if isinstance(m, nn.Conv2d):
                n = m.kernel_size[0] * m.kernel_size[1] * m.out_channels
                m.weight.data.normal_(0, math.sqrt(2. / n))
            elif isinstance(m, nn.BatchNorm2d):
                m.weight.data.fill_(1)
                m.bias.data.zero_()


    def forward(self, x):
        x = self.conv1(x)

        x = self.stages[0](x)
        x = self.stages[1](x)
        out3 = self.stages[2](x)
        out4 = self.stages[3](out3)
        out5 = self.stages[4](out4)

        return out3, out4, out5

def darknet53(pretrained, **kwargs):
    model = CSPDarkNet([1, 2, 8, 8, 4])
    if pretrained:
        if isinstance(pretrained, str):
            model.load_state_dict(torch.load(pretrained))
        else:
            raise Exception(&quot;darknet request a pretrained path. got [{}]&quot;.format(pretrained))
    return model
</code></pre><h2 id="2&#x3001;&#x7279;&#x5F81;&#x91D1;&#x5B57;&#x5854;"><a name="2&#x3001;&#x7279;&#x5F81;&#x91D1;&#x5B57;&#x5854;" class="anchor-navigation-ex-anchor" href="#2&#x3001;&#x7279;&#x5F81;&#x91D1;&#x5B57;&#x5854;"><i class="fa fa-link" aria-hidden="true"></i></a>6.2. 2&#x3001;&#x7279;&#x5F81;&#x91D1;&#x5B57;&#x5854;</h2>
<p>&#x5F53;&#x8F93;&#x5165;&#x662F; 416x416 &#x65F6;&#xFF0C;&#x7279;&#x5F81;&#x7ED3;&#x6784;&#x5982;&#x4E0B;&#xFF1A;<br><img src="https://img-blog.csdnimg.cn/20200512144007178.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDc5MTk2NA==,size_16,color_FFFFFF,t_70#pic_center" alt=""><br>&#x5F53;&#x8F93;&#x5165;&#x662F; 608x608 &#x65F6;&#xFF0C;&#x7279;&#x5F81;&#x7ED3;&#x6784;&#x5982;&#x4E0B;&#xFF1A;<br><img src="https://img-blog.csdnimg.cn/20200509213429592.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDc5MTk2NA==,size_16,color_FFFFFF,t_70#pic_center" alt=""><br>&#x5728;&#x7279;&#x5F81;&#x91D1;&#x5B57;&#x5854;&#x90E8;&#x5206;&#xFF0C;YOLOV4 &#x7ED3;&#x5408;&#x4E86;&#x4E24;&#x79CD;&#x6539;&#x8FDB;:<br><strong>a). &#x4F7F;&#x7528;&#x4E86; SPP &#x7ED3;&#x6784;&#x3002;<br>b). &#x4F7F;&#x7528;&#x4E86; PANet &#x7ED3;&#x6784;&#x3002;</strong><br>&#x5982;&#x4E0A;&#x56FE;&#x6240;&#x793A;&#xFF0C;&#x9664;&#x53BB; CSPDarknet53 &#x548C; Yolo Head &#x7684;&#x7ED3;&#x6784;&#x5916;&#xFF0C;&#x90FD;&#x662F;&#x7279;&#x5F81;&#x91D1;&#x5B57;&#x5854;&#x7684;&#x7ED3;&#x6784;&#x3002;<br>1&#x3001;SPP &#x7ED3;&#x6784;&#x53C2;&#x6742;&#x5728;<strong>&#x5BF9; CSPdarknet53 &#x7684;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x7279;&#x5F81;&#x5C42;&#x7684;&#x5377;&#x79EF;&#x91CC;</strong>&#xFF0C;&#x5728;<strong>&#x5BF9; CSPdarknet53 &#x7684;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x7279;&#x5F81;&#x5C42;&#x8FDB;&#x884C;&#x4E09;&#x6B21; DarknetConv2D_BN_Leaky &#x5377;&#x79EF;&#x540E;</strong>&#xFF0C;<strong>&#x5206;&#x522B;&#x5229;&#x7528;&#x56DB;&#x4E2A;&#x4E0D;&#x540C;&#x5C3A;&#x5EA6;&#x7684;&#x6700;&#x5927;&#x6C60;&#x5316;&#x8FDB;&#x884C;&#x5904;&#x7406;</strong>&#xFF0C;&#x6700;&#x5927;&#x6C60;&#x5316;&#x7684;<strong>&#x6C60;&#x5316;&#x6838;&#x5927;&#x5C0F;&#x5206;&#x522B;&#x4E3A; 13x13&#x3001;9x9&#x3001;5x5&#x3001;1x1&#xFF08;1x1 &#x5373;&#x65E0;&#x5904;&#x7406;&#xFF09;</strong></p>
<pre><code>#---------------------------------------------------#
#   SPP&#x7ED3;&#x6784;&#xFF0C;&#x5229;&#x7528;&#x4E0D;&#x540C;&#x5927;&#x5C0F;&#x7684;&#x6C60;&#x5316;&#x6838;&#x8FDB;&#x884C;&#x6C60;&#x5316;
#   &#x6C60;&#x5316;&#x540E;&#x5806;&#x53E0;
#---------------------------------------------------#
class SpatialPyramidPooling(nn.Module):
    def __init__(self, pool_sizes=[5, 9, 13]):
        super(SpatialPyramidPooling, self).__init__()

        self.maxpools = nn.ModuleList([nn.MaxPool2d(pool_size, 1, pool_size//2) for pool_size in pool_sizes])

    def forward(self, x):
        features = [maxpool(x) for maxpool in self.maxpools[::-1]]
        features = torch.cat(features + [x], dim=1)

        return features
</code></pre><p>&#x5176;&#x53EF;&#x4EE5;<strong>&#x5B83;&#x80FD;&#x591F;&#x6781;&#x5927;&#x5730;&#x589E;&#x52A0;&#x611F;&#x53D7;&#x91CE;&#xFF0C;&#x5206;&#x79BB;&#x51FA;&#x6700;&#x663E;&#x8457;&#x7684;&#x4E0A;&#x4E0B;&#x6587;&#x7279;&#x5F81;</strong>&#x3002;<br><img src="https://img-blog.csdnimg.cn/20200509215346310.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDc5MTk2NA==,size_16,color_FFFFFF,t_70#pic_center" alt=""><br>2&#x3001;PANet &#x662F; 2018 &#x7684;&#x4E00;&#x79CD;&#x5B9E;&#x4F8B;&#x5206;&#x5272;&#x7B97;&#x6CD5;&#xFF0C;&#x5176;&#x5177;&#x4F53;&#x7ED3;&#x6784;&#x7531;&#x53CD;&#x590D;&#x63D0;&#x5347;&#x7279;&#x5F81;&#x7684;&#x610F;&#x601D;&#x3002;<br><img src="https://img-blog.csdnimg.cn/20200509214653559.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDc5MTk2NA==,size_16,color_FFFFFF,t_70#pic_center" alt=""><br>&#x4E0A;&#x56FE;&#x4E3A;&#x539F;&#x59CB;&#x7684; PANet &#x7684;&#x7ED3;&#x6784;&#xFF0C;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#x6765;&#x5176;&#x5177;&#x6709;<strong>&#x4E00;&#x4E2A;&#x975E;&#x5E38;&#x91CD;&#x8981;&#x7684;&#x7279;&#x70B9;&#x5C31;&#x662F;&#x7279;&#x5F81;&#x7684;&#x53CD;&#x590D;&#x63D0;&#x53D6;</strong>&#x3002;<br>&#x5728;&#xFF08;a&#xFF09;&#x91CC;&#x9762;&#x662F;&#x4F20;&#x7EDF;&#x7684;&#x7279;&#x5F81;&#x91D1;&#x5B57;&#x5854;&#x7ED3;&#x6784;&#xFF0C;&#x5728;&#x5B8C;&#x6210;&#x7279;&#x5F81;&#x91D1;&#x5B57;&#x5854;&#x4ECE;<strong>&#x4E0B;&#x5230;&#x4E0A;&#x7684;&#x7279;&#x5F81;&#x63D0;&#x53D6;&#x540E;</strong>&#xFF0C;&#x8FD8;&#x9700;&#x8981;<strong>&#x5B9E;&#x73B0;&#xFF08;b&#xFF09;&#x4E2D;&#x4ECE;&#x4E0A;&#x5230;&#x4E0B;&#x7684;&#x7279;&#x5F81;&#x63D0;&#x53D6;&#x3002;</strong></p>
<p>&#x800C;&#x5728; YOLOV4 &#x5F53;&#x4E2D;&#xFF0C;&#x5176;&#x4E3B;&#x8981;&#x662F;&#x5728;<strong>&#x4E09;&#x4E2A;&#x6709;&#x6548;&#x7279;&#x5F81;&#x5C42;&#x4E0A;&#x4F7F;&#x7528;&#x4E86; PANet &#x7ED3;&#x6784;&#x3002;</strong><br><img src="https://img-blog.csdnimg.cn/20200509215322866.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDc5MTk2NA==,size_16,color_FFFFFF,t_70#pic_center" alt=""><br>&#x5B9E;&#x73B0;&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre><code>#---------------------------------------------------#
#   yolo_body
#---------------------------------------------------#
class YoloBody(nn.Module):
    def __init__(self, config):
        super(YoloBody, self).__init__()
        self.config = config
        #  backbone
        self.backbone = darknet53(None)

        self.conv1 = make_three_conv([512,1024],1024)
        self.SPP = SpatialPyramidPooling()
        self.conv2 = make_three_conv([512,1024],2048)

        self.upsample1 = Upsample(512,256)
        self.conv_for_P4 = conv2d(512,256,1)
        self.make_five_conv1 = make_five_conv([256, 512],512)

        self.upsample2 = Upsample(256,128)
        self.conv_for_P3 = conv2d(256,128,1)
        self.make_five_conv2 = make_five_conv([128, 256],256)
        # 3*(5+num_classes)=3*(5+20)=3*(4+1+20)=75
        final_out_filter2 = len(config[&quot;yolo&quot;][&quot;anchors&quot;][2]) * (5 + config[&quot;yolo&quot;][&quot;classes&quot;])
        self.yolo_head3 = yolo_head([256, final_out_filter2],128)

        self.down_sample1 = conv2d(128,256,3,stride=2)
        self.make_five_conv3 = make_five_conv([256, 512],512)
        # 3*(5+num_classes)=3*(5+20)=3*(4+1+20)=75
        final_out_filter1 = len(config[&quot;yolo&quot;][&quot;anchors&quot;][1]) * (5 + config[&quot;yolo&quot;][&quot;classes&quot;])
        self.yolo_head2 = yolo_head([512, final_out_filter1],256)


        self.down_sample2 = conv2d(256,512,3,stride=2)
        self.make_five_conv4 = make_five_conv([512, 1024],1024)
        # 3*(5+num_classes)=3*(5+20)=3*(4+1+20)=75
        final_out_filter0 = len(config[&quot;yolo&quot;][&quot;anchors&quot;][0]) * (5 + config[&quot;yolo&quot;][&quot;classes&quot;])
        self.yolo_head1 = yolo_head([1024, final_out_filter0],512)


    def forward(self, x):
        #  backbone
        x2, x1, x0 = self.backbone(x)

        P5 = self.conv1(x0)
        P5 = self.SPP(P5)
        P5 = self.conv2(P5)

        P5_upsample = self.upsample1(P5)
        P4 = self.conv_for_P4(x1)
        P4 = torch.cat([P4,P5_upsample],axis=1)
        P4 = self.make_five_conv1(P4)

        P4_upsample = self.upsample2(P4)
        P3 = self.conv_for_P3(x2)
        P3 = torch.cat([P3,P4_upsample],axis=1)
        P3 = self.make_five_conv2(P3)

        P3_downsample = self.down_sample1(P3)
        P4 = torch.cat([P3_downsample,P4],axis=1)
        P4 = self.make_five_conv3(P4)

        P4_downsample = self.down_sample2(P4)
        P5 = torch.cat([P4_downsample,P5],axis=1)
        P5 = self.make_five_conv4(P5)

        out2 = self.yolo_head3(P3)
        out1 = self.yolo_head2(P4)
        out0 = self.yolo_head1(P5)

        return out0, out1, out2
</code></pre><h2 id="3&#x3001;yolohead-&#x5229;&#x7528;&#x83B7;&#x5F97;&#x5230;&#x7684;&#x7279;&#x5F81;&#x8FDB;&#x884C;&#x9884;&#x6D4B;"><a name="3&#x3001;yolohead-&#x5229;&#x7528;&#x83B7;&#x5F97;&#x5230;&#x7684;&#x7279;&#x5F81;&#x8FDB;&#x884C;&#x9884;&#x6D4B;" class="anchor-navigation-ex-anchor" href="#3&#x3001;yolohead-&#x5229;&#x7528;&#x83B7;&#x5F97;&#x5230;&#x7684;&#x7279;&#x5F81;&#x8FDB;&#x884C;&#x9884;&#x6D4B;"><i class="fa fa-link" aria-hidden="true"></i></a>6.3. 3&#x3001;YoloHead &#x5229;&#x7528;&#x83B7;&#x5F97;&#x5230;&#x7684;&#x7279;&#x5F81;&#x8FDB;&#x884C;&#x9884;&#x6D4B;</h2>
<p>&#x5F53;&#x8F93;&#x5165;&#x662F; 416x416 &#x65F6;&#xFF0C;&#x7279;&#x5F81;&#x7ED3;&#x6784;&#x5982;&#x4E0B;&#xFF1A;<br><img src="https://img-blog.csdnimg.cn/20200512144007178.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDc5MTk2NA==,size_16,color_FFFFFF,t_70#pic_center" alt=""><br>&#x5F53;&#x8F93;&#x5165;&#x662F; 608x608 &#x65F6;&#xFF0C;&#x7279;&#x5F81;&#x7ED3;&#x6784;&#x5982;&#x4E0B;&#xFF1A;<br><img src="https://img-blog.csdnimg.cn/20200509213429592.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDc5MTk2NA==,size_16,color_FFFFFF,t_70#pic_center" alt=""><br>1&#x3001;&#x5728;&#x7279;&#x5F81;&#x5229;&#x7528;&#x90E8;&#x5206;&#xFF0C;YoloV4 &#x63D0;&#x53D6;<strong>&#x591A;&#x7279;&#x5F81;&#x5C42;&#x8FDB;&#x884C;&#x76EE;&#x6807;&#x68C0;&#x6D4B;</strong>&#xFF0C;&#x4E00;&#x5171;<strong>&#x63D0;&#x53D6;&#x4E09;&#x4E2A;&#x7279;&#x5F81;&#x5C42;</strong>&#xFF0C;&#x5206;&#x522B;&#x4F4D;&#x4E8E;&#x4E2D;&#x95F4;&#x5C42;&#xFF0C;&#x4E2D;&#x4E0B;&#x5C42;&#xFF0C;&#x5E95;&#x5C42;&#xFF0C;&#x4E09;&#x4E2A;&#x7279;&#x5F81;&#x5C42;&#x7684; shape &#x5206;&#x522B;&#x4E3A; (76,76,256)&#x3001;(38,38,512)&#x3001;(19,19,1024)&#x3002;</p>
<p>2&#x3001;&#x8F93;&#x51FA;&#x5C42;&#x7684; shape &#x5206;&#x522B;&#x4E3A; (<strong>19,19,75</strong>)&#xFF0C;(<strong>38,38,75</strong>)&#xFF0C;(<strong>76,76,75</strong>)&#xFF0C;<strong>&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x7EF4;&#x5EA6;&#x4E3A; 75 &#x662F;&#x56E0;&#x4E3A;&#x8BE5;&#x56FE;&#x662F;&#x57FA;&#x4E8E; voc &#x6570;&#x636E;&#x96C6;&#x7684;&#xFF0C;&#x5B83;&#x7684;&#x7C7B;&#x4E3A; 20 &#x79CD;&#xFF0C;YoloV4 &#x53EA;&#x6709;&#x9488;&#x5BF9;&#x6BCF;&#x4E00;&#x4E2A;&#x7279;&#x5F81;&#x5C42;&#x5B58;&#x5728; 3 &#x4E2A;&#x5148;&#x9A8C;&#x6846;&#xFF0C;&#x6240;&#x4EE5;&#x6700;&#x540E;&#x7EF4;&#x5EA6;&#x4E3A; 3x25&#xFF1B;<br>&#x5982;&#x679C;&#x4F7F;&#x7528;&#x7684;&#x662F; coco &#x8BAD;&#x7EC3;&#x96C6;&#xFF0C;&#x7C7B;&#x5219;&#x4E3A; 80 &#x79CD;&#xFF0C;&#x6700;&#x540E;&#x7684;&#x7EF4;&#x5EA6;&#x5E94;&#x8BE5;&#x4E3A; 255 = 3x85</strong>&#xFF0C;&#x4E09;&#x4E2A;&#x7279;&#x5F81;&#x5C42;&#x7684; shape &#x4E3A; (<strong>19,19,255</strong>)&#xFF0C;(<strong>38,38,255</strong>)&#xFF0C;(<strong>76,76,255</strong>)</p>
<p>&#x5B9E;&#x73B0;&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre><code>#---------------------------------------------------#
#   &#x6700;&#x540E;&#x83B7;&#x5F97;yolov4&#x7684;&#x8F93;&#x51FA;
#---------------------------------------------------#
def yolo_head(filters_list, in_filters):
    m = nn.Sequential(
        conv2d(in_filters, filters_list[0], 3),
        nn.Conv2d(filters_list[0], filters_list[1], 1),
    )
    return m

#---------------------------------------------------#
#   yolo_body
#---------------------------------------------------#
class YoloBody(nn.Module):
    def __init__(self, config):
        super(YoloBody, self).__init__()
        self.config = config
        #  backbone
        self.backbone = darknet53(None)

        self.conv1 = make_three_conv([512,1024],1024)
        self.SPP = SpatialPyramidPooling()
        self.conv2 = make_three_conv([512,1024],2048)

        self.upsample1 = Upsample(512,256)
        self.conv_for_P4 = conv2d(512,256,1)
        self.make_five_conv1 = make_five_conv([256, 512],512)

        self.upsample2 = Upsample(256,128)
        self.conv_for_P3 = conv2d(256,128,1)
        self.make_five_conv2 = make_five_conv([128, 256],256)
        # 3*(5+num_classes)=3*(5+20)=3*(4+1+20)=75
        final_out_filter2 = len(config[&quot;yolo&quot;][&quot;anchors&quot;][2]) * (5 + config[&quot;yolo&quot;][&quot;classes&quot;])
        self.yolo_head3 = yolo_head([256, final_out_filter2],128)

        self.down_sample1 = conv2d(128,256,3,stride=2)
        self.make_five_conv3 = make_five_conv([256, 512],512)
        # 3*(5+num_classes)=3*(5+20)=3*(4+1+20)=75
        final_out_filter1 = len(config[&quot;yolo&quot;][&quot;anchors&quot;][1]) * (5 + config[&quot;yolo&quot;][&quot;classes&quot;])
        self.yolo_head2 = yolo_head([512, final_out_filter1],256)


        self.down_sample2 = conv2d(256,512,3,stride=2)
        self.make_five_conv4 = make_five_conv([512, 1024],1024)
        # 3*(5+num_classes)=3*(5+20)=3*(4+1+20)=75
        final_out_filter0 = len(config[&quot;yolo&quot;][&quot;anchors&quot;][0]) * (5 + config[&quot;yolo&quot;][&quot;classes&quot;])
        self.yolo_head1 = yolo_head([1024, final_out_filter0],512)


    def forward(self, x):
        #  backbone
        x2, x1, x0 = self.backbone(x)

        P5 = self.conv1(x0)
        P5 = self.SPP(P5)
        P5 = self.conv2(P5)

        P5_upsample = self.upsample1(P5)
        P4 = self.conv_for_P4(x1)
        P4 = torch.cat([P4,P5_upsample],axis=1)
        P4 = self.make_five_conv1(P4)

        P4_upsample = self.upsample2(P4)
        P3 = self.conv_for_P3(x2)
        P3 = torch.cat([P3,P4_upsample],axis=1)
        P3 = self.make_five_conv2(P3)

        P3_downsample = self.down_sample1(P3)
        P4 = torch.cat([P3_downsample,P4],axis=1)
        P4 = self.make_five_conv3(P4)

        P4_downsample = self.down_sample2(P4)
        P5 = torch.cat([P4_downsample,P5],axis=1)
        P5 = self.make_five_conv4(P5)

        out2 = self.yolo_head3(P3)
        out1 = self.yolo_head2(P4)
        out0 = self.yolo_head1(P5)

        return out0, out1, out2
</code></pre><h2 id="4&#x3001;&#x9884;&#x6D4B;&#x7ED3;&#x679C;&#x7684;&#x89E3;&#x7801;"><a name="4&#x3001;&#x9884;&#x6D4B;&#x7ED3;&#x679C;&#x7684;&#x89E3;&#x7801;" class="anchor-navigation-ex-anchor" href="#4&#x3001;&#x9884;&#x6D4B;&#x7ED3;&#x679C;&#x7684;&#x89E3;&#x7801;"><i class="fa fa-link" aria-hidden="true"></i></a>6.4. 4&#x3001;&#x9884;&#x6D4B;&#x7ED3;&#x679C;&#x7684;&#x89E3;&#x7801;</h2>
<p>&#x7531;&#x7B2C;&#x4E8C;&#x6B65;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x83B7;&#x5F97;&#x4E09;&#x4E2A;&#x7279;&#x5F81;&#x5C42;&#x7684;&#x9884;&#x6D4B;&#x7ED3;&#x679C;&#xFF0C;shape &#x5206;&#x522B;&#x4E3A; (<strong>N,19,19,255</strong>)&#xFF0C;(<strong>N,38,38,255</strong>)&#xFF0C;(<strong>N,76,76,255</strong>) &#x7684;&#x6570;&#x636E;&#xFF0C;&#x5BF9;&#x5E94;&#x6BCF;&#x4E2A;&#x56FE;&#x5206;&#x4E3A; 19x19&#x3001;38x38&#x3001;76x76 &#x7684;&#x7F51;&#x683C;&#x4E0A; 3 &#x4E2A;&#x9884;&#x6D4B;&#x6846;&#x7684;&#x4F4D;&#x7F6E;&#x3002;</p>
<p>&#x4F46;&#x662F;&#x8FD9;&#x4E2A;&#x9884;&#x6D4B;&#x7ED3;&#x679C;&#x5E76;&#x4E0D;&#x5BF9;&#x5E94;&#x7740;&#x6700;&#x7EC8;&#x7684;&#x9884;&#x6D4B;&#x6846;&#x5728;&#x56FE;&#x7247;&#x4E0A;&#x7684;&#x4F4D;&#x7F6E;&#xFF0C;&#x8FD8;&#x9700;&#x8981;&#x89E3;&#x7801;&#x624D;&#x53EF;&#x4EE5;&#x5B8C;&#x6210;&#x3002;</p>
<p>&#x6B64;&#x5904;&#x8981;&#x8BB2;&#x4E00;&#x4E0B; yolo3 &#x7684;&#x9884;&#x6D4B;&#x539F;&#x7406;&#xFF0C;yolo3 &#x7684; 3 &#x4E2A;&#x7279;&#x5F81;&#x5C42;&#x5206;&#x522B;&#x5C06;&#x6574;&#x5E45;&#x56FE;&#x5206;&#x4E3A; 19x19&#x3001;38x38&#x3001;76x76 &#x7684;&#x7F51;&#x683C;&#xFF0C;&#x6BCF;&#x4E2A;&#x7F51;&#x7EDC;&#x70B9;&#x8D1F;&#x8D23;&#x4E00;&#x4E2A;&#x533A;&#x57DF;&#x7684;&#x68C0;&#x6D4B;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x77E5;&#x9053;&#x7279;&#x5F81;&#x5C42;&#x7684;&#x9884;&#x6D4B;&#x7ED3;&#x679C;&#x5BF9;&#x5E94;&#x7740;&#x4E09;&#x4E2A;&#x9884;&#x6D4B;&#x6846;&#x7684;&#x4F4D;&#x7F6E;&#xFF0C;&#x6211;&#x4EEC;&#x5148;&#x5C06;&#x5176; reshape &#x4E00;&#x4E0B;&#xFF0C;&#x5176;&#x7ED3;&#x679C;&#x4E3A; (<strong>N,19,19,3,85</strong>)&#xFF0C;(<strong>N,38,38,3,85</strong>)&#xFF0C;(<strong>N,76,76,3,85</strong>)&#x3002;</p>
<p>&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x7EF4;&#x5EA6;&#x4E2D;&#x7684; 85 &#x5305;&#x542B;&#x4E86; 4+1+80&#xFF0C;<strong>&#x5206;&#x522B;&#x4EE3;&#x8868; x_offset&#x3001;y_offset&#x3001;h &#x548C; w&#x3001;&#x7F6E;&#x4FE1;&#x5EA6;&#x3001;&#x5206;&#x7C7B;&#x7ED3;&#x679C;&#x3002;</strong></p>
<p>yolo3 &#x7684;&#x89E3;&#x7801;&#x8FC7;&#x7A0B;&#x5C31;&#x662F;<strong>&#x5C06;&#x6BCF;&#x4E2A;&#x7F51;&#x683C;&#x70B9;&#x52A0;&#x4E0A;&#x5B83;&#x5BF9;&#x5E94;&#x7684; x_offset &#x548C; y_offset</strong>&#xFF0C;&#x52A0;&#x5B8C;&#x540E;&#x7684;&#x7ED3;&#x679C;&#x5C31;&#x662F;<strong>&#x9884;&#x6D4B;&#x6846;&#x7684;&#x4E2D;&#x5FC3;</strong>&#xFF0C;&#x7136;&#x540E;<strong>&#x518D;&#x5229;&#x7528; &#x5148;&#x9A8C;&#x6846;&#x548C; h&#x3001;w &#x7ED3;&#x5408; &#x8BA1;&#x7B97;&#x51FA;&#x9884;&#x6D4B;&#x6846;&#x7684;&#x957F;&#x548C;&#x5BBD;</strong>&#x3002;&#x8FD9;&#x6837;&#x5C31;&#x80FD;&#x5F97;&#x5230;&#x6574;&#x4E2A;&#x9884;&#x6D4B;&#x6846;&#x7684;&#x4F4D;&#x7F6E;&#x4E86;&#x3002;</p>
<p><img src="https://img-blog.csdnimg.cn/20191120215015351.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDc5MTk2NA==,size_16,color_FFFFFF,t_70#pic_center" alt=""><br>&#x5F53;&#x7136;&#x5F97;&#x5230;&#x6700;&#x7EC8;&#x7684;&#x9884;&#x6D4B;&#x7ED3;&#x6784;&#x540E;&#x8FD8;&#x8981;&#x8FDB;&#x884C;&#x5F97;&#x5206;&#x6392;&#x5E8F;&#x4E0E;&#x975E;&#x6781;&#x5927;&#x6291;&#x5236;&#x7B5B;&#x9009;<br>&#x8FD9;&#x4E00;&#x90E8;&#x5206;&#x57FA;&#x672C;&#x4E0A;&#x662F;&#x6240;&#x6709;&#x76EE;&#x6807;&#x68C0;&#x6D4B;&#x901A;&#x7528;&#x7684;&#x90E8;&#x5206;&#x3002;&#x4E0D;&#x8FC7;&#x8BE5;&#x9879;&#x76EE;&#x7684;&#x5904;&#x7406;&#x65B9;&#x5F0F;&#x4E0E;&#x5176;&#x5B83;&#x9879;&#x76EE;&#x4E0D;&#x540C;&#x3002;&#x5176;&#x5BF9;&#x4E8E;&#x6BCF;&#x4E00;&#x4E2A;&#x7C7B;&#x8FDB;&#x884C;&#x5224;&#x522B;&#x3002;<br><strong>1&#x3001;&#x53D6;&#x51FA;&#x6BCF;&#x4E00;&#x7C7B;&#x5F97;&#x5206;&#x5927;&#x4E8E; self.obj_threshold &#x7684;&#x6846;&#x548C;&#x5F97;&#x5206;&#x3002;<br>2&#x3001;&#x5229;&#x7528;&#x6846;&#x7684;&#x4F4D;&#x7F6E;&#x548C;&#x5F97;&#x5206;&#x8FDB;&#x884C;&#x975E;&#x6781;&#x5927;&#x6291;&#x5236;&#x3002;</strong></p>
<p>&#x5B9E;&#x73B0;&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF0C;&#x5F53;&#x8C03;&#x7528; yolo_eval &#x65F6;&#xFF0C;&#x5C31;&#x4F1A;&#x5BF9;&#x6BCF;&#x4E2A;&#x7279;&#x5F81;&#x5C42;&#x8FDB;&#x884C;&#x89E3;&#x7801;&#xFF1A;</p>
<pre><code>class DecodeBox(nn.Module):
    def __init__(self, anchors, num_classes, img_size):
        super(DecodeBox, self).__init__()
        self.anchors = anchors
        self.num_anchors = len(anchors)
        self.num_classes = num_classes
        self.bbox_attrs = 5 + num_classes
        self.img_size = img_size

    def forward(self, input):
        # input&#x4E3A;bs,3*(1+4+num_classes),13,13

        # &#x4E00;&#x5171;&#x591A;&#x5C11;&#x5F20;&#x56FE;&#x7247;
        batch_size = input.size(0)
        # 13&#xFF0C;13
        input_height = input.size(2)
        input_width = input.size(3)

        # &#x8BA1;&#x7B97;&#x6B65;&#x957F;
        # &#x6BCF;&#x4E00;&#x4E2A;&#x7279;&#x5F81;&#x70B9;&#x5BF9;&#x5E94;&#x539F;&#x6765;&#x7684;&#x56FE;&#x7247;&#x4E0A;&#x591A;&#x5C11;&#x4E2A;&#x50CF;&#x7D20;&#x70B9;
        # &#x5982;&#x679C;&#x7279;&#x5F81;&#x5C42;&#x4E3A;13x13&#x7684;&#x8BDD;&#xFF0C;&#x4E00;&#x4E2A;&#x7279;&#x5F81;&#x70B9;&#x5C31;&#x5BF9;&#x5E94;&#x539F;&#x6765;&#x7684;&#x56FE;&#x7247;&#x4E0A;&#x7684;32&#x4E2A;&#x50CF;&#x7D20;&#x70B9;
        # 416/13 = 32
        stride_h = self.img_size[1] / input_height
        stride_w = self.img_size[0] / input_width

        # &#x628A;&#x5148;&#x9A8C;&#x6846;&#x7684;&#x5C3A;&#x5BF8;&#x8C03;&#x6574;&#x6210;&#x7279;&#x5F81;&#x5C42;&#x5927;&#x5C0F;&#x7684;&#x5F62;&#x5F0F;
        # &#x8BA1;&#x7B97;&#x51FA;&#x5148;&#x9A8C;&#x6846;&#x5728;&#x7279;&#x5F81;&#x5C42;&#x4E0A;&#x5BF9;&#x5E94;&#x7684;&#x5BBD;&#x9AD8;
        scaled_anchors = [(anchor_width / stride_w, anchor_height / stride_h) for anchor_width, anchor_height in self.anchors]

        # bs,3*(5+num_classes),13,13 -&gt; bs,3,13,13,(5+num_classes)
        prediction = input.view(batch_size, self.num_anchors,
                                self.bbox_attrs, input_height, input_width).permute(0, 1, 3, 4, 2).contiguous()

        # &#x5148;&#x9A8C;&#x6846;&#x7684;&#x4E2D;&#x5FC3;&#x4F4D;&#x7F6E;&#x7684;&#x8C03;&#x6574;&#x53C2;&#x6570;
        x = torch.sigmoid(prediction[..., 0])  
        y = torch.sigmoid(prediction[..., 1])
        # &#x5148;&#x9A8C;&#x6846;&#x7684;&#x5BBD;&#x9AD8;&#x8C03;&#x6574;&#x53C2;&#x6570;
        w = prediction[..., 2]  # Width
        h = prediction[..., 3]  # Height

        # &#x83B7;&#x5F97;&#x7F6E;&#x4FE1;&#x5EA6;&#xFF0C;&#x662F;&#x5426;&#x6709;&#x7269;&#x4F53;
        conf = torch.sigmoid(prediction[..., 4])
        # &#x79CD;&#x7C7B;&#x7F6E;&#x4FE1;&#x5EA6;
        pred_cls = torch.sigmoid(prediction[..., 5:])  # Cls pred.

        FloatTensor = torch.cuda.FloatTensor if x.is_cuda else torch.FloatTensor
        LongTensor = torch.cuda.LongTensor if x.is_cuda else torch.LongTensor

        # &#x751F;&#x6210;&#x7F51;&#x683C;&#xFF0C;&#x5148;&#x9A8C;&#x6846;&#x4E2D;&#x5FC3;&#xFF0C;&#x7F51;&#x683C;&#x5DE6;&#x4E0A;&#x89D2; batch_size,3,13,13
        grid_x = torch.linspace(0, input_width - 1, input_width).repeat(input_width, 1).repeat(
            batch_size * self.num_anchors, 1, 1).view(x.shape).type(FloatTensor)
        grid_y = torch.linspace(0, input_height - 1, input_height).repeat(input_height, 1).t().repeat(
            batch_size * self.num_anchors, 1, 1).view(y.shape).type(FloatTensor)

        # &#x751F;&#x6210;&#x5148;&#x9A8C;&#x6846;&#x7684;&#x5BBD;&#x9AD8;
        anchor_w = FloatTensor(scaled_anchors).index_select(1, LongTensor([0]))
        anchor_h = FloatTensor(scaled_anchors).index_select(1, LongTensor([1]))
        anchor_w = anchor_w.repeat(batch_size, 1).repeat(1, 1, input_height * input_width).view(w.shape)
        anchor_h = anchor_h.repeat(batch_size, 1).repeat(1, 1, input_height * input_width).view(h.shape)

        # &#x8BA1;&#x7B97;&#x8C03;&#x6574;&#x540E;&#x7684;&#x5148;&#x9A8C;&#x6846;&#x4E2D;&#x5FC3;&#x4E0E;&#x5BBD;&#x9AD8;
        pred_boxes = FloatTensor(prediction[..., :4].shape)
        pred_boxes[..., 0] = x.data + grid_x
        pred_boxes[..., 1] = y.data + grid_y
        pred_boxes[..., 2] = torch.exp(w.data) * anchor_w
        pred_boxes[..., 3] = torch.exp(h.data) * anchor_h

        # &#x7528;&#x4E8E;&#x5C06;&#x8F93;&#x51FA;&#x8C03;&#x6574;&#x4E3A;&#x76F8;&#x5BF9;&#x4E8E;416x416&#x7684;&#x5927;&#x5C0F;
        _scale = torch.Tensor([stride_w, stride_h] * 2).type(FloatTensor)
        output = torch.cat((pred_boxes.view(batch_size, -1, 4) * _scale,
                            conf.view(batch_size, -1, 1), pred_cls.view(batch_size, -1, self.num_classes)), -1)
        return output.data
</code></pre><h2 id="5&#x3001;&#x5728;&#x539F;&#x56FE;&#x4E0A;&#x8FDB;&#x884C;&#x7ED8;&#x5236;"><a name="5&#x3001;&#x5728;&#x539F;&#x56FE;&#x4E0A;&#x8FDB;&#x884C;&#x7ED8;&#x5236;" class="anchor-navigation-ex-anchor" href="#5&#x3001;&#x5728;&#x539F;&#x56FE;&#x4E0A;&#x8FDB;&#x884C;&#x7ED8;&#x5236;"><i class="fa fa-link" aria-hidden="true"></i></a>6.5. 5&#x3001;&#x5728;&#x539F;&#x56FE;&#x4E0A;&#x8FDB;&#x884C;&#x7ED8;&#x5236;</h2>
<p>&#x901A;&#x8FC7;&#x7B2C;&#x56DB;&#x6B65;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x83B7;&#x5F97;&#x9884;&#x6D4B;&#x6846;&#x5728;&#x539F;&#x56FE;&#x4E0A;&#x7684;&#x4F4D;&#x7F6E;&#xFF0C;&#x800C;&#x4E14;&#x8FD9;&#x4E9B;&#x9884;&#x6D4B;&#x6846;&#x90FD;&#x662F;&#x7ECF;&#x8FC7;&#x7B5B;&#x9009;&#x7684;&#x3002;&#x8FD9;&#x4E9B;&#x7B5B;&#x9009;&#x540E;&#x7684;&#x6846;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x7ED8;&#x5236;&#x5728;&#x56FE;&#x7247;&#x4E0A;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x83B7;&#x5F97;&#x7ED3;&#x679C;&#x4E86;&#x3002;</p>
<h1 id="yolov4-&#x7684;&#x8BAD;&#x7EC3;"><a name="yolov4-&#x7684;&#x8BAD;&#x7EC3;" class="anchor-navigation-ex-anchor" href="#yolov4-&#x7684;&#x8BAD;&#x7EC3;"><i class="fa fa-link" aria-hidden="true"></i></a>7. YOLOV4 &#x7684;&#x8BAD;&#x7EC3;</h1>
<h2 id="1&#x3001;yolov4-&#x7684;&#x6539;&#x8FDB;&#x8BAD;&#x7EC3;&#x6280;&#x5DE7;"><a name="1&#x3001;yolov4-&#x7684;&#x6539;&#x8FDB;&#x8BAD;&#x7EC3;&#x6280;&#x5DE7;" class="anchor-navigation-ex-anchor" href="#1&#x3001;yolov4-&#x7684;&#x6539;&#x8FDB;&#x8BAD;&#x7EC3;&#x6280;&#x5DE7;"><i class="fa fa-link" aria-hidden="true"></i></a>7.1. 1&#x3001;YOLOV4 &#x7684;&#x6539;&#x8FDB;&#x8BAD;&#x7EC3;&#x6280;&#x5DE7;</h2>
<h3 id="a&#x3001;mosaic-&#x6570;&#x636E;&#x589E;&#x5F3A;"><a name="a&#x3001;mosaic-&#x6570;&#x636E;&#x589E;&#x5F3A;" class="anchor-navigation-ex-anchor" href="#a&#x3001;mosaic-&#x6570;&#x636E;&#x589E;&#x5F3A;"><i class="fa fa-link" aria-hidden="true"></i></a>7.1.1. a)&#x3001;Mosaic &#x6570;&#x636E;&#x589E;&#x5F3A;</h3>
<p>Yolov4 &#x7684; mosaic &#x6570;&#x636E;&#x589E;&#x5F3A;&#x53C2;&#x8003;&#x4E86; CutMix &#x6570;&#x636E;&#x589E;&#x5F3A;&#x65B9;&#x5F0F;&#xFF0C;&#x7406;&#x8BBA;&#x4E0A;&#x5177;&#x6709;&#x4E00;&#x5B9A;&#x7684;&#x76F8;&#x4F3C;&#x6027;&#xFF01;<br><strong>CutMix &#x6570;&#x636E;&#x589E;&#x5F3A;&#x65B9;&#x5F0F;&#x5229;&#x7528;&#x4E24;&#x5F20;&#x56FE;&#x7247;&#x8FDB;&#x884C;&#x62FC;&#x63A5;&#x3002;</strong><br><img src="https://img-blog.csdnimg.cn/20200508145223449.png#pic_center" alt=""><br>&#x4F46;&#x662F; mosaic &#x5229;&#x7528;&#x4E86;&#x56DB;&#x5F20;&#x56FE;&#x7247;&#xFF0C;<strong>&#x6839;&#x636E;&#x8BBA;&#x6587;&#x6240;&#x8BF4;&#x5176;&#x62E5;&#x6709;&#x4E00;&#x4E2A;&#x5DE8;&#x5927;&#x7684;&#x4F18;&#x70B9;&#x662F;&#x4E30;&#x5BCC;&#x68C0;&#x6D4B;&#x7269;&#x4F53;&#x7684;&#x80CC;&#x666F;&#xFF01;&#x4E14;&#x5728; BN &#x8BA1;&#x7B97;&#x7684;&#x65F6;&#x5019;&#x4E00;&#x4E0B;&#x5B50;&#x4F1A;&#x8BA1;&#x7B97;&#x56DB;&#x5F20;&#x56FE;&#x7247;&#x7684;&#x6570;&#x636E;&#xFF01;</strong><br>&#x5C31;&#x50CF;&#x4E0B;&#x56FE;&#x8FD9;&#x6837;&#xFF1A;<br><img src="https://img-blog.csdnimg.cn/20200508145439305.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDc5MTk2NA==,size_16,color_FFFFFF,t_70#pic_center" alt=""><br>&#x5B9E;&#x73B0;&#x601D;&#x8DEF;&#x5982;&#x4E0B;&#xFF1A;<br>1&#x3001;&#x6BCF;&#x6B21;&#x8BFB;&#x53D6;&#x56DB;&#x5F20;&#x56FE;&#x7247;&#x3002;</p>
<p><img src="https://img-blog.csdnimg.cn/20200508155913308.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDc5MTk2NA==,size_16,color_FFFFFF,t_70#pic_center" alt=""><br><img src="https://img-blog.csdnimg.cn/20200508155925719.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDc5MTk2NA==,size_16,color_FFFFFF,t_70#pic_center" alt=""><br><img src="https://img-blog.csdnimg.cn/20200508155933988.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDc5MTk2NA==,size_16,color_FFFFFF,t_70#pic_center" alt=""><br><img src="https://img-blog.csdnimg.cn/20200508155946892.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDc5MTk2NA==,size_16,color_FFFFFF,t_70#pic_center" alt=""><br>2&#x3001;&#x5206;&#x522B;&#x5BF9;&#x56DB;&#x5F20;&#x56FE;&#x7247;&#x8FDB;&#x884C;&#x7FFB;&#x8F6C;&#x3001;&#x7F29;&#x653E;&#x3001;&#x8272;&#x57DF;&#x53D8;&#x5316;&#x7B49;&#xFF0C;&#x5E76;&#x4E14;&#x6309;&#x7167;&#x56DB;&#x4E2A;&#x65B9;&#x5411;&#x4F4D;&#x7F6E;&#x6446;&#x597D;&#x3002;<br><img src="https://img-blog.csdnimg.cn/20200508160000580.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDc5MTk2NA==,size_16,color_FFFFFF,t_70#pic_center" alt=""><br><img src="https://img-blog.csdnimg.cn/20200508160015434.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDc5MTk2NA==,size_16,color_FFFFFF,t_70#pic_center" alt=""><br><img src="https://img-blog.csdnimg.cn/20200508160028438.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDc5MTk2NA==,size_16,color_FFFFFF,t_70#pic_center" alt=""><br><img src="https://img-blog.csdnimg.cn/20200508160038303.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDc5MTk2NA==,size_16,color_FFFFFF,t_70#pic_center" alt=""><br>3&#x3001;&#x8FDB;&#x884C;&#x56FE;&#x7247;&#x7684;&#x7EC4;&#x5408;&#x548C;&#x6846;&#x7684;&#x7EC4;&#x5408;<br><img src="https://img-blog.csdnimg.cn/20200508160045845.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDc5MTk2NA==,size_16,color_FFFFFF,t_70#pic_center" alt=""></p>
<pre><code>def rand(a=0, b=1):
    return np.random.rand()*(b-a) + a

def merge_bboxes(bboxes, cutx, cuty):

    merge_bbox = []
    for i in range(len(bboxes)):
        for box in bboxes[i]:
            tmp_box = []
            x1,y1,x2,y2 = box[0], box[1], box[2], box[3]

            if i == 0:
                if y1 &gt; cuty or x1 &gt; cutx:
                    continue
                if y2 &gt;= cuty and y1 &lt;= cuty:
                    y2 = cuty
                    if y2-y1 &lt; 5:
                        continue
                if x2 &gt;= cutx and x1 &lt;= cutx:
                    x2 = cutx
                    if x2-x1 &lt; 5:
                        continue

            if i == 1:
                if y2 &lt; cuty or x1 &gt; cutx:
                    continue

                if y2 &gt;= cuty and y1 &lt;= cuty:
                    y1 = cuty
                    if y2-y1 &lt; 5:
                        continue

                if x2 &gt;= cutx and x1 &lt;= cutx:
                    x2 = cutx
                    if x2-x1 &lt; 5:
                        continue

            if i == 2:
                if y2 &lt; cuty or x2 &lt; cutx:
                    continue

                if y2 &gt;= cuty and y1 &lt;= cuty:
                    y1 = cuty
                    if y2-y1 &lt; 5:
                        continue

                if x2 &gt;= cutx and x1 &lt;= cutx:
                    x1 = cutx
                    if x2-x1 &lt; 5:
                        continue

            if i == 3:
                if y1 &gt; cuty or x2 &lt; cutx:
                    continue

                if y2 &gt;= cuty and y1 &lt;= cuty:
                    y2 = cuty
                    if y2-y1 &lt; 5:
                        continue

                if x2 &gt;= cutx and x1 &lt;= cutx:
                    x1 = cutx
                    if x2-x1 &lt; 5:
                        continue

            tmp_box.append(x1)
            tmp_box.append(y1)
            tmp_box.append(x2)
            tmp_box.append(y2)
            tmp_box.append(box[-1])
            merge_bbox.append(tmp_box)
    return merge_bbox

def get_random_data(annotation_line, input_shape, random=True, hue=.1, sat=1.5, val=1.5, proc_img=True):
    &apos;&apos;&apos;random preprocessing for real-time data augmentation&apos;&apos;&apos;
    h, w = input_shape
    min_offset_x = 0.4
    min_offset_y = 0.4
    scale_low = 1-min(min_offset_x,min_offset_y)
    scale_high = scale_low+0.2

    image_datas = [] 
    box_datas = []
    index = 0

    place_x = [0,0,int(w*min_offset_x),int(w*min_offset_x)]
    place_y = [0,int(h*min_offset_y),int(w*min_offset_y),0]
    for line in annotation_line:
        # &#x6BCF;&#x4E00;&#x884C;&#x8FDB;&#x884C;&#x5206;&#x5272;
        line_content = line.split()
        # &#x6253;&#x5F00;&#x56FE;&#x7247;
        image = Image.open(line_content[0])
        image = image.convert(&quot;RGB&quot;) 
        # &#x56FE;&#x7247;&#x7684;&#x5927;&#x5C0F;
        iw, ih = image.size
        # &#x4FDD;&#x5B58;&#x6846;&#x7684;&#x4F4D;&#x7F6E;
        box = np.array([np.array(list(map(int,box.split(&apos;,&apos;)))) for box in line_content[1:]])

        # image.save(str(index)+&quot;.jpg&quot;)
        # &#x662F;&#x5426;&#x7FFB;&#x8F6C;&#x56FE;&#x7247;
        flip = rand()&lt;.5
        if flip and len(box)&gt;0:
            image = image.transpose(Image.FLIP_LEFT_RIGHT)
            box[:, [0,2]] = iw - box[:, [2,0]]

        # &#x5BF9;&#x8F93;&#x5165;&#x8FDB;&#x6765;&#x7684;&#x56FE;&#x7247;&#x8FDB;&#x884C;&#x7F29;&#x653E;
        new_ar = w/h
        scale = rand(scale_low, scale_high)
        if new_ar &lt; 1:
            nh = int(scale*h)
            nw = int(nh*new_ar)
        else:
            nw = int(scale*w)
            nh = int(nw/new_ar)
        image = image.resize((nw,nh), Image.BICUBIC)

        # &#x8FDB;&#x884C;&#x8272;&#x57DF;&#x53D8;&#x6362;
        hue = rand(-hue, hue)
        sat = rand(1, sat) if rand()&lt;.5 else 1/rand(1, sat)
        val = rand(1, val) if rand()&lt;.5 else 1/rand(1, val)
        x = rgb_to_hsv(np.array(image)/255.)
        x[..., 0] += hue
        x[..., 0][x[..., 0]&gt;1] -= 1
        x[..., 0][x[..., 0]&lt;0] += 1
        x[..., 1] *= sat
        x[..., 2] *= val
        x[x&gt;1] = 1
        x[x&lt;0] = 0
        image = hsv_to_rgb(x)

        image = Image.fromarray((image*255).astype(np.uint8))
        # &#x5C06;&#x56FE;&#x7247;&#x8FDB;&#x884C;&#x653E;&#x7F6E;&#xFF0C;&#x5206;&#x522B;&#x5BF9;&#x5E94;&#x56DB;&#x5F20;&#x5206;&#x5272;&#x56FE;&#x7247;&#x7684;&#x4F4D;&#x7F6E;
        dx = place_x[index]
        dy = place_y[index]
        new_image = Image.new(&apos;RGB&apos;, (w,h), (128,128,128))
        new_image.paste(image, (dx, dy))
        image_data = np.array(new_image)/255

        # Image.fromarray((image_data*255).astype(np.uint8)).save(str(index)+&quot;distort.jpg&quot;)

        index = index + 1
        box_data = []
        # &#x5BF9;box&#x8FDB;&#x884C;&#x91CD;&#x65B0;&#x5904;&#x7406;
        if len(box)&gt;0:
            np.random.shuffle(box)
            box[:, [0,2]] = box[:, [0,2]]*nw/iw + dx
            box[:, [1,3]] = box[:, [1,3]]*nh/ih + dy
            box[:, 0:2][box[:, 0:2]&lt;0] = 0
            box[:, 2][box[:, 2]&gt;w] = w
            box[:, 3][box[:, 3]&gt;h] = h
            box_w = box[:, 2] - box[:, 0]
            box_h = box[:, 3] - box[:, 1]
            box = box[np.logical_and(box_w&gt;1, box_h&gt;1)]
            box_data = np.zeros((len(box),5))
            box_data[:len(box)] = box

        image_datas.append(image_data)
        box_datas.append(box_data)

        img = Image.fromarray((image_data*255).astype(np.uint8))
        for j in range(len(box_data)):
            thickness = 3
            left, top, right, bottom  = box_data[j][0:4]
            draw = ImageDraw.Draw(img)
            for i in range(thickness):
                draw.rectangle([left + i, top + i, right - i, bottom - i],outline=(255,255,255))
        img.show()


    # &#x5C06;&#x56FE;&#x7247;&#x5206;&#x5272;&#xFF0C;&#x653E;&#x5728;&#x4E00;&#x8D77;
    cutx = np.random.randint(int(w*min_offset_x), int(w*(1 - min_offset_x)))
    cuty = np.random.randint(int(h*min_offset_y), int(h*(1 - min_offset_y)))

    new_image = np.zeros([h,w,3])
    new_image[:cuty, :cutx, :] = image_datas[0][:cuty, :cutx, :]
    new_image[cuty:, :cutx, :] = image_datas[1][cuty:, :cutx, :]
    new_image[cuty:, cutx:, :] = image_datas[2][cuty:, cutx:, :]
    new_image[:cuty, cutx:, :] = image_datas[3][:cuty, cutx:, :]

    # &#x5BF9;&#x6846;&#x8FDB;&#x884C;&#x8FDB;&#x4E00;&#x6B65;&#x7684;&#x5904;&#x7406;
    new_boxes = merge_bboxes(box_datas, cutx, cuty)

    return new_image, new_boxes
</code></pre><h3 id="b&#x3001;label-smoothing-&#x5E73;&#x6ED1;"><a name="b&#x3001;label-smoothing-&#x5E73;&#x6ED1;" class="anchor-navigation-ex-anchor" href="#b&#x3001;label-smoothing-&#x5E73;&#x6ED1;"><i class="fa fa-link" aria-hidden="true"></i></a>7.1.2. b)&#x3001;Label Smoothing &#x5E73;&#x6ED1;</h3>
<p>&#x6807;&#x7B7E;&#x5E73;&#x6ED1;&#x7684;&#x601D;&#x60F3;&#x5F88;&#x7B80;&#x5355;&#xFF0C;&#x5177;&#x4F53;&#x516C;&#x5F0F;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre><code>new_onehot_labels = onehot_labels * (1 - label_smoothing) + label_smoothing / num_classes
</code></pre><p>&#x5F53; label_smoothing &#x7684;&#x503C;&#x4E3A; 0.01 &#x5F97;&#x65F6;&#x5019;&#xFF0C;&#x516C;&#x5F0F;&#x53D8;&#x6210;&#x5982;&#x4E0B;&#x6240;&#x793A;&#xFF1A;</p>
<pre><code>new_onehot_labels = y * (1 - 0.01) + 0.01 / num_classes
</code></pre><p>&#x5176;&#x5B9E; Label Smoothing &#x5E73;&#x6ED1;&#x5C31;&#x662F;&#x5C06;&#x6807;&#x7B7E;&#x8FDB;&#x884C;&#x4E00;&#x4E2A;&#x5E73;&#x6ED1;&#xFF0C;&#x539F;&#x59CB;&#x7684;&#x6807;&#x7B7E;&#x662F; 0&#x3001;1&#xFF0C;&#x5728;&#x5E73;&#x6ED1;&#x540E;&#x53D8;&#x6210; 0.005(&#x5982;&#x679C;&#x662F;&#x4E8C;&#x5206;&#x7C7B;)&#x3001;0.995&#xFF0C;<strong>&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#x5BF9;&#x5206;&#x7C7B;&#x51C6;&#x786E;&#x505A;&#x4E86;&#x4E00;&#x70B9;&#x60E9;&#x7F5A;&#xFF0C;&#x8BA9;&#x6A21;&#x578B;&#x4E0D;&#x53EF;&#x4EE5;&#x5206;&#x7C7B;&#x7684;&#x592A;&#x51C6;&#x786E;&#xFF0C;&#x592A;&#x51C6;&#x786E;&#x5BB9;&#x6613;&#x8FC7;&#x62DF;&#x5408;&#x3002;</strong></p>
<p>&#x5B9E;&#x73B0;&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre><code>#---------------------------------------------------#
#   &#x5E73;&#x6ED1;&#x6807;&#x7B7E;
#---------------------------------------------------#
def smooth_labels(y_true, label_smoothing,num_classes):
    return y_true * (1.0 - label_smoothing) + label_smoothing / num_classes
</code></pre><h3 id="c&#x3001;ciou"><a name="c&#x3001;ciou" class="anchor-navigation-ex-anchor" href="#c&#x3001;ciou"><i class="fa fa-link" aria-hidden="true"></i></a>7.1.3. c)&#x3001;CIOU</h3>
<p>IoU &#x662F;&#x6BD4;&#x503C;&#x7684;&#x6982;&#x5FF5;&#xFF0C;&#x5BF9;&#x76EE;&#x6807;&#x7269;&#x4F53;&#x7684; scale &#x662F;&#x4E0D;&#x654F;&#x611F;&#x7684;&#x3002;<strong>&#x7136;&#x800C;&#x5E38;&#x7528;&#x7684; BBox &#x7684;&#x56DE;&#x5F52;&#x635F;&#x5931;&#x4F18;&#x5316;&#x548C; IoU &#x4F18;&#x5316;&#x4E0D;&#x662F;&#x5B8C;&#x5168;&#x7B49;&#x4EF7;&#x7684;&#xFF0C;&#x5BFB;&#x5E38;&#x7684; IoU &#x65E0;&#x6CD5;&#x76F4;&#x63A5;&#x4F18;&#x5316;&#x6CA1;&#x6709;&#x91CD;&#x53E0;&#x7684;&#x90E8;&#x5206;&#x3002;</strong></p>
<p>&#x4E8E;&#x662F;&#x6709;&#x4EBA;&#x63D0;&#x51FA;&#x76F4;&#x63A5;&#x4F7F;&#x7528; IOU &#x4F5C;&#x4E3A;&#x56DE;&#x5F52;&#x4F18;&#x5316; loss&#xFF0C;CIOU &#x662F;&#x5176;&#x4E2D;&#x975E;&#x5E38;&#x4F18;&#x79C0;&#x7684;&#x4E00;&#x79CD;&#x60F3;&#x6CD5;&#x3002;</p>
<p>CIOU &#x5C06;&#x76EE;&#x6807;&#x4E0E; anchor &#x4E4B;&#x95F4;&#x7684;&#x8DDD;&#x79BB;&#xFF0C;&#x91CD;&#x53E0;&#x7387;&#x3001;&#x5C3A;&#x5EA6;&#x4EE5;&#x53CA;&#x60E9;&#x7F5A;&#x9879;&#x90FD;&#x8003;&#x8651;&#x8FDB;&#x53BB;&#xFF0C;<strong>&#x4F7F;&#x5F97;&#x76EE;&#x6807;&#x6846;&#x56DE;&#x5F52;&#x53D8;&#x5F97;&#x66F4;&#x52A0;&#x7A33;&#x5B9A;&#xFF0C;&#x4E0D;&#x4F1A;&#x50CF; IoU &#x548C; GIoU &#x4E00;&#x6837;&#x51FA;&#x73B0;&#x8BAD;&#x7EC3;&#x8FC7;&#x7A0B;&#x4E2D;&#x53D1;&#x6563;&#x7B49;&#x95EE;&#x9898;&#x3002;&#x800C;&#x60E9;&#x7F5A;&#x56E0;&#x5B50;&#x628A;&#x9884;&#x6D4B;&#x6846;&#x957F;&#x5BBD;&#x6BD4;&#x62DF;&#x5408;&#x76EE;&#x6807;&#x6846;&#x7684;&#x957F;&#x5BBD;&#x6BD4;&#x8003;&#x8651;&#x8FDB;&#x53BB;&#x3002;</strong></p>
<p><img src="https://img-blog.csdnimg.cn/20200425144646161.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDc5MTk2NA==,size_16,color_FFFFFF,t_70#pic_center" alt=""><br>CIOU &#x516C;&#x5F0F;&#x5982;&#x4E0B;<br>C I O U = I O U &#x2212; &#x3C1; 2 ( b , b g t ) c 2 &#x2212; &#x3B1; v CIOU = IOU - \frac{\rho^2(b,b^{gt})}{c^2} - \alpha v CIOU=IOU&#x2212;c2&#x3C1;2(b,bgt)&#x200B;&#x2212;&#x3B1;v<br>&#x5176;&#x4E2D;&#xFF0C; &#x3C1; 2 ( b , b g t ) \rho^2(b,b^{gt}) &#x3C1;2(b,bgt) &#x5206;&#x522B;<strong>&#x4EE3;&#x8868;&#x4E86;&#x9884;&#x6D4B;&#x6846;&#x548C;&#x771F;&#x5B9E;&#x6846;&#x7684;&#x4E2D;&#x5FC3;&#x70B9;&#x7684;&#x6B27;&#x5F0F;&#x8DDD;&#x79BB;&#x3002; c &#x4EE3;&#x8868;&#x7684;&#x662F;&#x80FD;&#x591F;&#x540C;&#x65F6;&#x5305;&#x542B;&#x9884;&#x6D4B;&#x6846;&#x548C;&#x771F;&#x5B9E;&#x6846;&#x7684;&#x6700;&#x5C0F;&#x95ED;&#x5305;&#x533A;&#x57DF;&#x7684;&#x5BF9;&#x89D2;&#x7EBF;&#x8DDD;&#x79BB;&#x3002;</strong></p>
<p>&#x800C; &#x3B1; \alpha &#x3B1;&#x548C; v v v &#x7684;&#x516C;&#x5F0F;&#x5982;&#x4E0B;<br>&#x3B1; = v 1 &#x2212; I O U + v \alpha = \frac{v}{1-IOU+v} &#x3B1;=1&#x2212;IOU+vv&#x200B;<br>v = 4 &#x3C0; 2 ( a r c t a n w g t h g t &#x2212; a r c t a n w h ) 2 v = \frac{4}{\pi ^2}(arctan\frac{w^{gt}}{h^{gt}}-arctan\frac{w}{h})^2 v=&#x3C0;24&#x200B;(arctanhgtwgt&#x200B;&#x2212;arctanhw&#x200B;)2<br>&#x628A; 1-CIOU &#x5C31;&#x53EF;&#x4EE5;&#x5F97;&#x5230;&#x76F8;&#x5E94;&#x7684; LOSS &#x4E86;&#x3002;<br>L O S S C I O U = 1 &#x2212; I O U + &#x3C1; 2 ( b , b g t ) c 2 + &#x3B1; v LOSS_{CIOU} = 1 - IOU + \frac{\rho^2(b,b^{gt})}{c^2} + \alpha v LOSSCIOU&#x200B;=1&#x2212;IOU+c2&#x3C1;2(b,bgt)&#x200B;+&#x3B1;v</p>
<pre><code>def box_ciou(b1, b2):
    &quot;&quot;&quot;
    &#x8F93;&#x5165;&#x4E3A;&#xFF1A;
    ----------
    b1: tensor, shape=(batch, feat_w, feat_h, anchor_num, 4), xywh
    b2: tensor, shape=(batch, feat_w, feat_h, anchor_num, 4), xywh

    &#x8FD4;&#x56DE;&#x4E3A;&#xFF1A;
    -------
    ciou: tensor, shape=(batch, feat_w, feat_h, anchor_num, 1)
    &quot;&quot;&quot;
    # &#x6C42;&#x51FA;&#x9884;&#x6D4B;&#x6846;&#x5DE6;&#x4E0A;&#x89D2;&#x53F3;&#x4E0B;&#x89D2;
    b1_xy = b1[..., :2]
    b1_wh = b1[..., 2:4]
    b1_wh_half = b1_wh/2.
    b1_mins = b1_xy - b1_wh_half
    b1_maxes = b1_xy + b1_wh_half
    # &#x6C42;&#x51FA;&#x771F;&#x5B9E;&#x6846;&#x5DE6;&#x4E0A;&#x89D2;&#x53F3;&#x4E0B;&#x89D2;
    b2_xy = b2[..., :2]
    b2_wh = b2[..., 2:4]
    b2_wh_half = b2_wh/2.
    b2_mins = b2_xy - b2_wh_half
    b2_maxes = b2_xy + b2_wh_half

    # &#x6C42;&#x771F;&#x5B9E;&#x6846;&#x548C;&#x9884;&#x6D4B;&#x6846;&#x6240;&#x6709;&#x7684;iou
    intersect_mins = torch.max(b1_mins, b2_mins)
    intersect_maxes = torch.min(b1_maxes, b2_maxes)
    intersect_wh = torch.max(intersect_maxes - intersect_mins, torch.zeros_like(intersect_maxes))
    intersect_area = intersect_wh[..., 0] * intersect_wh[..., 1]
    b1_area = b1_wh[..., 0] * b1_wh[..., 1]
    b2_area = b2_wh[..., 0] * b2_wh[..., 1]
    union_area = b1_area + b2_area - intersect_area
    iou = intersect_area / (union_area + 1e-6)

    # &#x8BA1;&#x7B97;&#x4E2D;&#x5FC3;&#x7684;&#x5DEE;&#x8DDD;
    center_distance = torch.sum(torch.pow((b1_xy - b2_xy), 2), axis=-1)
    # &#x627E;&#x5230;&#x5305;&#x88F9;&#x4E24;&#x4E2A;&#x6846;&#x7684;&#x6700;&#x5C0F;&#x6846;&#x7684;&#x5DE6;&#x4E0A;&#x89D2;&#x548C;&#x53F3;&#x4E0B;&#x89D2;
    enclose_mins = torch.min(b1_mins, b2_mins)
    enclose_maxes = torch.max(b1_maxes, b2_maxes)
    enclose_wh = torch.max(enclose_maxes - enclose_mins, torch.zeros_like(intersect_maxes))
    # &#x8BA1;&#x7B97;&#x5BF9;&#x89D2;&#x7EBF;&#x8DDD;&#x79BB;
    enclose_diagonal = torch.sum(torch.pow(enclose_wh,2), axis=-1)
    ciou = iou - 1.0 * (center_distance) / (enclose_diagonal + 1e-7)

    v = (4 / (math.pi ** 2)) * torch.pow((torch.atan(b1_wh[..., 0]/b1_wh[..., 1]) - torch.atan(b2_wh[..., 0]/b2_wh[..., 1])), 2)
    alpha = v / (1.0 - iou + v)
    ciou = ciou - alpha * v
    return ciou
</code></pre><h3 id="d&#x3001;&#x5B66;&#x4E60;&#x7387;&#x4F59;&#x5F26;&#x9000;&#x706B;&#x8870;&#x51CF;"><a name="d&#x3001;&#x5B66;&#x4E60;&#x7387;&#x4F59;&#x5F26;&#x9000;&#x706B;&#x8870;&#x51CF;" class="anchor-navigation-ex-anchor" href="#d&#x3001;&#x5B66;&#x4E60;&#x7387;&#x4F59;&#x5F26;&#x9000;&#x706B;&#x8870;&#x51CF;"><i class="fa fa-link" aria-hidden="true"></i></a>7.1.4. d)&#x3001;&#x5B66;&#x4E60;&#x7387;&#x4F59;&#x5F26;&#x9000;&#x706B;&#x8870;&#x51CF;</h3>
<p>&#x4F59;&#x5F26;&#x9000;&#x706B;&#x8870;&#x51CF;&#x6CD5;&#xFF0C;&#x5B66;&#x4E60;&#x7387;&#x4F1A;&#x5148;&#x4E0A;&#x5347;&#x518D;&#x4E0B;&#x964D;&#xFF0C;&#x8FD9;&#x662F;&#x9000;&#x706B;&#x4F18;&#x5316;&#x6CD5;&#x7684;&#x601D;&#x60F3;&#x3002;&#xFF08;&#x5173;&#x4E8E;&#x4EC0;&#x4E48;&#x662F;&#x9000;&#x706B;&#x7B97;&#x6CD5;&#x53EF;&#x4EE5;&#x767E;&#x5EA6;&#x3002;&#xFF09;</p>
<p>&#x4E0A;&#x5347;&#x7684;&#x65F6;&#x5019;&#x4F7F;&#x7528;&#x7EBF;&#x6027;&#x4E0A;&#x5347;&#xFF0C;&#x4E0B;&#x964D;&#x7684;&#x65F6;&#x5019;&#x6A21;&#x62DF; cos &#x51FD;&#x6570;&#x4E0B;&#x964D;&#x3002;&#x6267;&#x884C;&#x591A;&#x6B21;&#x3002;</p>
<p>&#x6548;&#x679C;&#x5982;&#x56FE;&#x6240;&#x793A;&#xFF1A;<br><img src="https://img-blog.csdnimg.cn/20200519151307934.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDc5MTk2NA==,size_16,color_FFFFFF,t_70#pic_center" alt=""><br>pytorch &#x6709;&#x76F4;&#x63A5;&#x5B9E;&#x73B0;&#x7684;&#x51FD;&#x6570;&#xFF0C;&#x53EF;&#x76F4;&#x63A5;&#x8C03;&#x7528;&#x3002;</p>
<pre><code>lr_scheduler = optim.lr_scheduler.CosineAnnealingLR(optimizer, T_max=5, eta_min=1e-5)
</code></pre><h2 id="2&#x3001;loss-&#x7EC4;&#x6210;"><a name="2&#x3001;loss-&#x7EC4;&#x6210;" class="anchor-navigation-ex-anchor" href="#2&#x3001;loss-&#x7EC4;&#x6210;"><i class="fa fa-link" aria-hidden="true"></i></a>7.2. 2&#x3001;loss &#x7EC4;&#x6210;</h2>
<h3 id="a&#x3001;&#x8BA1;&#x7B97;-loss-&#x6240;&#x9700;&#x53C2;&#x6570;"><a name="a&#x3001;&#x8BA1;&#x7B97;-loss-&#x6240;&#x9700;&#x53C2;&#x6570;" class="anchor-navigation-ex-anchor" href="#a&#x3001;&#x8BA1;&#x7B97;-loss-&#x6240;&#x9700;&#x53C2;&#x6570;"><i class="fa fa-link" aria-hidden="true"></i></a>7.2.1. a)&#x3001;&#x8BA1;&#x7B97; loss &#x6240;&#x9700;&#x53C2;&#x6570;</h3>
<p>&#x5728;&#x8BA1;&#x7B97; loss &#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5B9E;&#x9645;&#x4E0A;&#x662F; y_pre &#x548C; y_true &#x4E4B;&#x95F4;&#x7684;&#x5BF9;&#x6BD4;&#xFF1A;<br>y_pre &#x5C31;&#x662F;&#x4E00;&#x5E45;<strong>&#x56FE;&#x50CF;&#x7ECF;&#x8FC7;&#x7F51;&#x7EDC;&#x4E4B;&#x540E;&#x7684;&#x8F93;&#x51FA;&#xFF0C;&#x5185;&#x90E8;&#x542B;&#x6709;&#x4E09;&#x4E2A;&#x7279;&#x5F81;&#x5C42;&#x7684;&#x5185;&#x5BB9;&#xFF1B;&#x5176;&#x9700;&#x8981;&#x89E3;&#x7801;&#x624D;&#x80FD;&#x591F;&#x5728;&#x56FE;&#x4E0A;&#x4F5C;&#x753B;</strong><br>y_true &#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x771F;&#x5B9E;&#x56FE;&#x50CF;&#x4E2D;&#xFF0C;&#x5B83;&#x7684;<strong>&#x6BCF;&#x4E2A;&#x771F;&#x5B9E;&#x6846;&#x5BF9;&#x5E94;&#x7684; (19,19)&#x3001;(38,38)&#x3001;(76,76) &#x7F51;&#x683C;&#x4E0A;&#x7684;&#x504F;&#x79FB;&#x4F4D;&#x7F6E;&#x3001;&#x957F;&#x5BBD;&#x4E0E;&#x79CD;&#x7C7B;&#x3002;&#x5176;&#x4ECD;&#x9700;&#x8981;&#x7F16;&#x7801;&#x624D;&#x80FD;&#x4E0E; y_pred &#x7684;&#x7ED3;&#x6784;&#x4E00;&#x81F4;</strong><br>&#x5B9E;&#x9645;&#x4E0A; y_pre &#x548C; y_true &#x5185;&#x5BB9;&#x7684; shape &#x90FD;&#x662F;<br>(batch_size,19,19,3,85)<br>(batch_size,38,38,3,85)<br>(batch_size,76,76,3,85)</p>
<h3 id="b&#x3001;ypre-&#x662F;&#x4EC0;&#x4E48;"><a name="b&#x3001;ypre-&#x662F;&#x4EC0;&#x4E48;" class="anchor-navigation-ex-anchor" href="#b&#x3001;ypre-&#x662F;&#x4EC0;&#x4E48;"><i class="fa fa-link" aria-hidden="true"></i></a>7.2.2. b)&#x3001;y_pre &#x662F;&#x4EC0;&#x4E48;</h3>
<p>&#x7F51;&#x7EDC;<strong>&#x6700;&#x540E;&#x8F93;&#x51FA;&#x7684;&#x5185;&#x5BB9;&#x5C31;&#x662F;&#x4E09;&#x4E2A;&#x7279;&#x5F81;&#x5C42;&#x6BCF;&#x4E2A;&#x7F51;&#x683C;&#x70B9;&#x5BF9;&#x5E94;&#x7684;&#x9884;&#x6D4B;&#x6846;&#x53CA;&#x5176;&#x79CD;&#x7C7B;</strong>&#xFF0C;&#x5373;&#x4E09;&#x4E2A;&#x7279;&#x5F81;&#x5C42;&#x5206;&#x522B;&#x5BF9;&#x5E94;&#x7740;&#x56FE;&#x7247;&#x88AB;&#x5206;&#x4E3A;&#x4E0D;&#x540C; size &#x7684;&#x7F51;&#x683C;&#x540E;&#xFF0C;<strong>&#x6BCF;&#x4E2A;&#x7F51;&#x683C;&#x70B9;&#x4E0A;&#x4E09;&#x4E2A;&#x5148;&#x9A8C;&#x6846;&#x5BF9;&#x5E94;&#x7684;&#x4F4D;&#x7F6E;&#x3001;&#x7F6E;&#x4FE1;&#x5EA6;&#x53CA;&#x5176;&#x79CD;&#x7C7B;&#x3002;</strong><br>&#x5BF9;&#x4E8E;<strong>&#x8F93;&#x51FA;&#x7684; y1&#x3001;y2&#x3001;y3 &#x800C;&#x8A00;&#xFF0C;[&#x2026;, : 2] &#x6307;&#x7684;&#x662F;&#x76F8;&#x5BF9;&#x4E8E;&#x6BCF;&#x4E2A;&#x7F51;&#x683C;&#x70B9;&#x7684;&#x504F;&#x79FB;&#x91CF;&#xFF0C;[&#x2026;, 2: 4] &#x6307;&#x7684;&#x662F;&#x5BBD;&#x548C;&#x9AD8;&#xFF0C;[&#x2026;, 4: 5] &#x6307;&#x7684;&#x662F;&#x8BE5;&#x6846;&#x7684;&#x7F6E;&#x4FE1;&#x5EA6;&#xFF0C;[&#x2026;, 5: ] &#x6307;&#x7684;&#x662F;&#x6BCF;&#x4E2A;&#x79CD;&#x7C7B;&#x7684;&#x9884;&#x6D4B;&#x6982;&#x7387;&#x3002;</strong><br>&#x73B0;&#x5728;&#x7684; y_pre &#x8FD8;&#x662F;&#x6CA1;&#x6709;&#x89E3;&#x7801;&#x7684;&#xFF0C;&#x89E3;&#x7801;&#x4E86;&#x4E4B;&#x540E;&#x624D;&#x662F;&#x771F;&#x5B9E;&#x56FE;&#x50CF;&#x4E0A;&#x7684;&#x60C5;&#x51B5;&#x3002;</p>
<h3 id="c&#x3001;ytrue-&#x662F;&#x4EC0;&#x4E48;&#x3002;"><a name="c&#x3001;ytrue-&#x662F;&#x4EC0;&#x4E48;&#x3002;" class="anchor-navigation-ex-anchor" href="#c&#x3001;ytrue-&#x662F;&#x4EC0;&#x4E48;&#x3002;"><i class="fa fa-link" aria-hidden="true"></i></a>7.2.3. c)&#x3001;y_true &#x662F;&#x4EC0;&#x4E48;&#x3002;</h3>
<p>y_true &#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x771F;&#x5B9E;&#x56FE;&#x50CF;&#x4E2D;&#xFF0C;&#x5B83;&#x7684;<strong>&#x6BCF;&#x4E2A;&#x771F;&#x5B9E;&#x6846;&#x5BF9;&#x5E94;&#x7684; (19,19)&#x3001;(38,38)&#x3001;(76,76) &#x7F51;&#x683C;&#x4E0A;&#x7684;&#x504F;&#x79FB;&#x4F4D;&#x7F6E;&#x3001;&#x957F;&#x5BBD;&#x4E0E;&#x79CD;&#x7C7B;&#x3002;&#x5176;&#x4ECD;&#x9700;&#x8981;&#x7F16;&#x7801;&#x624D;&#x80FD;&#x4E0E; y_pred &#x7684;&#x7ED3;&#x6784;&#x4E00;&#x81F4;</strong></p>
<h3 id="d&#x3001;loss-&#x7684;&#x8BA1;&#x7B97;&#x8FC7;&#x7A0B;"><a name="d&#x3001;loss-&#x7684;&#x8BA1;&#x7B97;&#x8FC7;&#x7A0B;" class="anchor-navigation-ex-anchor" href="#d&#x3001;loss-&#x7684;&#x8BA1;&#x7B97;&#x8FC7;&#x7A0B;"><i class="fa fa-link" aria-hidden="true"></i></a>7.2.4. d)&#x3001;loss &#x7684;&#x8BA1;&#x7B97;&#x8FC7;&#x7A0B;</h3>
<p>&#x5728;&#x5F97;&#x5230;&#x4E86; y_pre &#x548C; y_true &#x540E;&#x600E;&#x4E48;&#x5BF9;&#x6BD4;&#x5462;&#xFF1F;&#x4E0D;&#x662F;&#x7B80;&#x5355;&#x7684;&#x51CF;&#x4E00;&#x4E0B;!</p>
<p>loss &#x503C;&#x9700;&#x8981;&#x5BF9;&#x4E09;&#x4E2A;&#x7279;&#x5F81;&#x5C42;&#x8FDB;&#x884C;&#x5904;&#x7406;&#xFF0C;&#x8FD9;&#x91CC;&#x4EE5;&#x6700;&#x5C0F;&#x7684;&#x7279;&#x5F81;&#x5C42;&#x4E3A;&#x4F8B;&#x3002;<br><strong>1&#x3001;&#x5229;&#x7528; y_true &#x53D6;&#x51FA;&#x8BE5;&#x7279;&#x5F81;&#x5C42;&#x4E2D;&#x771F;&#x5B9E;&#x5B58;&#x5728;&#x76EE;&#x6807;&#x7684;&#x70B9;&#x7684;&#x4F4D;&#x7F6E; (m,19,19,3,1) &#x53CA;&#x5176;&#x5BF9;&#x5E94;&#x7684;&#x79CD;&#x7C7B;(m,19,19,3,80)&#x3002;<br>2&#x3001;&#x5C06; prediction &#x7684;&#x9884;&#x6D4B;&#x503C;&#x8F93;&#x51FA;&#x8FDB;&#x884C;&#x5904;&#x7406;&#xFF0C;&#x5F97;&#x5230; reshape &#x540E;&#x7684;&#x9884;&#x6D4B;&#x503C; y_pre&#xFF0C;shape &#x4E3A; (m,19,19,3,85)&#x3002;&#x8FD8;&#x6709;&#x89E3;&#x7801;&#x540E;&#x7684; xy&#xFF0C;wh&#x3002;<br>3&#x3001;&#x5BF9;&#x4E8E;&#x6BCF;&#x4E00;&#x5E45;&#x56FE;&#xFF0C;&#x8BA1;&#x7B97;&#x5176;&#x4E2D;&#x6240;&#x6709;&#x771F;&#x5B9E;&#x6846;&#x4E0E;&#x9884;&#x6D4B;&#x6846;&#x7684; IOU&#xFF0C;&#x5982;&#x679C;&#x67D0;&#x4E9B;&#x9884;&#x6D4B;&#x6846;&#x548C;&#x771F;&#x5B9E;&#x6846;&#x7684;&#x91CD;&#x5408;&#x7A0B;&#x5EA6;&#x5927;&#x4E8E; 0.5&#xFF0C;&#x5219;&#x5FFD;&#x7565;&#x3002;<br>4&#x3001;&#x8BA1;&#x7B97; ciou &#x4F5C;&#x4E3A;&#x56DE;&#x5F52;&#x7684; loss&#xFF0C;&#x8FD9;&#x91CC;&#x53EA;&#x8BA1;&#x7B97;&#x6B63;&#x6837;&#x672C;&#x7684;&#x56DE;&#x5F52; loss&#x3002;<br>5&#x3001;&#x8BA1;&#x7B97;&#x7F6E;&#x4FE1;&#x5EA6;&#x7684; loss&#xFF0C;&#x5176;&#x6709;&#x4E24;&#x90E8;&#x5206;&#x6784;&#x6210;&#xFF0C;&#x7B2C;&#x4E00;&#x90E8;&#x5206;&#x662F;&#x5B9E;&#x9645;&#x4E0A;&#x5B58;&#x5728;&#x76EE;&#x6807;&#x7684;&#xFF0C;&#x9884;&#x6D4B;&#x7ED3;&#x679C;&#x4E2D;&#x7F6E;&#x4FE1;&#x5EA6;&#x7684;&#x503C;&#x4E0E; 1 &#x5BF9;&#x6BD4;&#xFF1B;&#x7B2C;&#x4E8C;&#x90E8;&#x5206;&#x662F;&#x5B9E;&#x9645;&#x4E0A;&#x4E0D;&#x5B58;&#x5728;&#x76EE;&#x6807;&#x7684;&#xFF0C;&#x5728;&#x7B2C;&#x56DB;&#x6B65;&#x4E2D;&#x5F97;&#x5230;&#x5176;&#x6700;&#x5927; IOU &#x7684;&#x503C;&#x4E0E; 0 &#x5BF9;&#x6BD4;&#x3002;<br>6&#x3001;&#x8BA1;&#x7B97;&#x9884;&#x6D4B;&#x79CD;&#x7C7B;&#x7684; loss&#xFF0C;&#x5176;&#x8BA1;&#x7B97;&#x7684;&#x662F;&#x5B9E;&#x9645;&#x4E0A;&#x5B58;&#x5728;&#x76EE;&#x6807;&#x7684;&#xFF0C;&#x9884;&#x6D4B;&#x7C7B;&#x4E0E;&#x771F;&#x5B9E;&#x7C7B;&#x7684;&#x5DEE;&#x8DDD;&#x3002;</strong></p>
<p>&#x5176;&#x5B9E;&#x9645;&#x4E0A;&#x8BA1;&#x7B97;&#x7684;&#x603B;&#x7684; loss &#x662F;&#x4E09;&#x4E2A; loss &#x7684;&#x548C;&#xFF0C;&#x8FD9;&#x4E09;&#x4E2A; loss &#x5206;&#x522B;&#x662F;&#xFF1A;</p>
<ul>
<li>&#x5B9E;&#x9645;&#x5B58;&#x5728;&#x7684;&#x6846;&#xFF0C;<strong>CIOU LOSS</strong>&#x3002;</li>
<li>&#x5B9E;&#x9645;&#x5B58;&#x5728;&#x7684;&#x6846;&#xFF0C;<strong>&#x9884;&#x6D4B;&#x7ED3;&#x679C;&#x4E2D;&#x7F6E;&#x4FE1;&#x5EA6;&#x7684;&#x503C;&#x4E0E; 1 &#x5BF9;&#x6BD4;&#xFF1B;&#x5B9E;&#x9645;&#x4E0D;&#x5B58;&#x5728;&#x7684;&#x6846;&#xFF0C;&#x9884;&#x6D4B;&#x7ED3;&#x679C;&#x4E2D;&#x7F6E;&#x4FE1;&#x5EA6;&#x7684;&#x503C;&#x4E0E; 0 &#x5BF9;&#x6BD4;&#xFF0C;&#x8BE5;&#x90E8;&#x5206;&#x8981;&#x53BB;&#x9664;&#x88AB;&#x5FFD;&#x7565;&#x7684;&#x4E0D;&#x5305;&#x542B;&#x76EE;&#x6807;&#x7684;&#x6846;</strong>&#x3002;</li>
<li>&#x5B9E;&#x9645;&#x5B58;&#x5728;&#x7684;&#x6846;&#xFF0C;<strong>&#x79CD;&#x7C7B;&#x9884;&#x6D4B;&#x7ED3;&#x679C;&#x4E0E;&#x5B9E;&#x9645;&#x7ED3;&#x679C;&#x7684;&#x5BF9;&#x6BD4;</strong>&#x3002;</li>
</ul>
<p>&#x5176;&#x5B9E;&#x9645;&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre><code>#---------------------------------------------------#
#   &#x5E73;&#x6ED1;&#x6807;&#x7B7E;
#---------------------------------------------------#
def smooth_labels(y_true, label_smoothing,num_classes):
    return y_true * (1.0 - label_smoothing) + label_smoothing / num_classes

def box_ciou(b1, b2):
    &quot;&quot;&quot;
    &#x8F93;&#x5165;&#x4E3A;&#xFF1A;
    ----------
    b1: tensor, shape=(batch, feat_w, feat_h, anchor_num, 4), xywh
    b2: tensor, shape=(batch, feat_w, feat_h, anchor_num, 4), xywh

    &#x8FD4;&#x56DE;&#x4E3A;&#xFF1A;
    -------
    ciou: tensor, shape=(batch, feat_w, feat_h, anchor_num, 1)
    &quot;&quot;&quot;
    # &#x6C42;&#x51FA;&#x9884;&#x6D4B;&#x6846;&#x5DE6;&#x4E0A;&#x89D2;&#x53F3;&#x4E0B;&#x89D2;
    b1_xy = b1[..., :2]
    b1_wh = b1[..., 2:4]
    b1_wh_half = b1_wh/2.
    b1_mins = b1_xy - b1_wh_half
    b1_maxes = b1_xy + b1_wh_half
    # &#x6C42;&#x51FA;&#x771F;&#x5B9E;&#x6846;&#x5DE6;&#x4E0A;&#x89D2;&#x53F3;&#x4E0B;&#x89D2;
    b2_xy = b2[..., :2]
    b2_wh = b2[..., 2:4]
    b2_wh_half = b2_wh/2.
    b2_mins = b2_xy - b2_wh_half
    b2_maxes = b2_xy + b2_wh_half

    # &#x6C42;&#x771F;&#x5B9E;&#x6846;&#x548C;&#x9884;&#x6D4B;&#x6846;&#x6240;&#x6709;&#x7684;iou
    intersect_mins = torch.max(b1_mins, b2_mins)
    intersect_maxes = torch.min(b1_maxes, b2_maxes)
    intersect_wh = torch.max(intersect_maxes - intersect_mins, torch.zeros_like(intersect_maxes))
    intersect_area = intersect_wh[..., 0] * intersect_wh[..., 1]
    b1_area = b1_wh[..., 0] * b1_wh[..., 1]
    b2_area = b2_wh[..., 0] * b2_wh[..., 1]
    union_area = b1_area + b2_area - intersect_area
    iou = intersect_area / (union_area + 1e-6)

    # &#x8BA1;&#x7B97;&#x4E2D;&#x5FC3;&#x7684;&#x5DEE;&#x8DDD;
    center_distance = torch.sum(torch.pow((b1_xy - b2_xy), 2), axis=-1)
    # &#x627E;&#x5230;&#x5305;&#x88F9;&#x4E24;&#x4E2A;&#x6846;&#x7684;&#x6700;&#x5C0F;&#x6846;&#x7684;&#x5DE6;&#x4E0A;&#x89D2;&#x548C;&#x53F3;&#x4E0B;&#x89D2;
    enclose_mins = torch.min(b1_mins, b2_mins)
    enclose_maxes = torch.max(b1_maxes, b2_maxes)
    enclose_wh = torch.max(enclose_maxes - enclose_mins, torch.zeros_like(intersect_maxes))
    # &#x8BA1;&#x7B97;&#x5BF9;&#x89D2;&#x7EBF;&#x8DDD;&#x79BB;
    enclose_diagonal = torch.sum(torch.pow(enclose_wh,2), axis=-1)
    ciou = iou - 1.0 * (center_distance) / (enclose_diagonal + 1e-7)

    v = (4 / (math.pi ** 2)) * torch.pow((torch.atan(b1_wh[..., 0]/b1_wh[..., 1]) - torch.atan(b2_wh[..., 0]/b2_wh[..., 1])), 2)
    alpha = v / (1.0 - iou + v)
    ciou = ciou - alpha * v
    return ciou

def clip_by_tensor(t,t_min,t_max):
    t=t.float()
    result = (t &gt;= t_min).float() * t + (t &lt; t_min).float() * t_min
    result = (result &lt;= t_max).float() * result + (result &gt; t_max).float() * t_max
    return result

def MSELoss(pred,target):
    return (pred-target)**2

def BCELoss(pred,target):
    epsilon = 1e-7
    pred = clip_by_tensor(pred, epsilon, 1.0 - epsilon)
    output = -target * torch.log(pred) - (1.0 - target) * torch.log(1.0 - pred)
    return output

class YOLOLoss(nn.Module):
    def __init__(self, anchors, num_classes, img_size, label_smooth=0, cuda=True):
        super(YOLOLoss, self).__init__()
        self.anchors = anchors
        self.num_anchors = len(anchors)
        self.num_classes = num_classes
        self.bbox_attrs = 5 + num_classes
        self.img_size = img_size
        self.label_smooth = label_smooth

        self.ignore_threshold = 0.5
        self.lambda_conf = 1.0
        self.lambda_cls = 1.0
        self.lambda_loc = 1.0
        self.cuda = cuda

    def forward(self, input, targets=None):
        # input&#x4E3A;bs,3*(5+num_classes),13,13

        # &#x4E00;&#x5171;&#x591A;&#x5C11;&#x5F20;&#x56FE;&#x7247;
        bs = input.size(0)
        # &#x7279;&#x5F81;&#x5C42;&#x7684;&#x9AD8;
        in_h = input.size(2)
        # &#x7279;&#x5F81;&#x5C42;&#x7684;&#x5BBD;
        in_w = input.size(3)

        # &#x8BA1;&#x7B97;&#x6B65;&#x957F;
        # &#x6BCF;&#x4E00;&#x4E2A;&#x7279;&#x5F81;&#x70B9;&#x5BF9;&#x5E94;&#x539F;&#x6765;&#x7684;&#x56FE;&#x7247;&#x4E0A;&#x591A;&#x5C11;&#x4E2A;&#x50CF;&#x7D20;&#x70B9;
        # &#x5982;&#x679C;&#x7279;&#x5F81;&#x5C42;&#x4E3A;13x13&#x7684;&#x8BDD;&#xFF0C;&#x4E00;&#x4E2A;&#x7279;&#x5F81;&#x70B9;&#x5C31;&#x5BF9;&#x5E94;&#x539F;&#x6765;&#x7684;&#x56FE;&#x7247;&#x4E0A;&#x7684;32&#x4E2A;&#x50CF;&#x7D20;&#x70B9;
        stride_h = self.img_size[1] / in_h
        stride_w = self.img_size[0] / in_w

        # &#x628A;&#x5148;&#x9A8C;&#x6846;&#x7684;&#x5C3A;&#x5BF8;&#x8C03;&#x6574;&#x6210;&#x7279;&#x5F81;&#x5C42;&#x5927;&#x5C0F;&#x7684;&#x5F62;&#x5F0F;
        # &#x8BA1;&#x7B97;&#x51FA;&#x5148;&#x9A8C;&#x6846;&#x5728;&#x7279;&#x5F81;&#x5C42;&#x4E0A;&#x5BF9;&#x5E94;&#x7684;&#x5BBD;&#x9AD8;
        scaled_anchors = [(a_w / stride_w, a_h / stride_h) for a_w, a_h in self.anchors]
        # bs,3*(5+num_classes),13,13 -&gt; bs,3,13,13,(5+num_classes)
        prediction = input.view(bs, int(self.num_anchors/3),
                                self.bbox_attrs, in_h, in_w).permute(0, 1, 3, 4, 2).contiguous()

        # &#x5BF9;prediction&#x9884;&#x6D4B;&#x8FDB;&#x884C;&#x8C03;&#x6574;
        conf = torch.sigmoid(prediction[..., 4])  # Conf
        pred_cls = torch.sigmoid(prediction[..., 5:])  # Cls pred.

        # &#x627E;&#x5230;&#x54EA;&#x4E9B;&#x5148;&#x9A8C;&#x6846;&#x5185;&#x90E8;&#x5305;&#x542B;&#x7269;&#x4F53;
        mask, noobj_mask, t_box, tconf, tcls, box_loss_scale_x, box_loss_scale_y = self.get_target(targets, scaled_anchors,in_w, in_h,self.ignore_threshold)

        noobj_mask, pred_boxes_for_ciou = self.get_ignore(prediction, targets, scaled_anchors, in_w, in_h, noobj_mask)

        if self.cuda:
            mask, noobj_mask = mask.cuda(), noobj_mask.cuda()
            box_loss_scale_x, box_loss_scale_y= box_loss_scale_x.cuda(), box_loss_scale_y.cuda()
            tconf, tcls = tconf.cuda(), tcls.cuda()
            pred_boxes_for_ciou = pred_boxes_for_ciou.cuda()
            t_box = t_box.cuda()

        box_loss_scale = 2-box_loss_scale_x*box_loss_scale_y
        #  losses.
        ciou = (1 - box_ciou( pred_boxes_for_ciou[mask.bool()], t_box[mask.bool()]))* box_loss_scale[mask.bool()]

        loss_loc = torch.sum(ciou / bs)
        loss_conf = torch.sum(BCELoss(conf, mask) * mask / bs) + \
                    torch.sum(BCELoss(conf, mask) * noobj_mask / bs)

        # print(smooth_labels(tcls[mask == 1],self.label_smooth,self.num_classes))
        loss_cls = torch.sum(BCELoss(pred_cls[mask == 1], smooth_labels(tcls[mask == 1],self.label_smooth,self.num_classes))/bs)
        # print(loss_loc,loss_conf,loss_cls)
        loss = loss_conf * self.lambda_conf + loss_cls * self.lambda_cls + loss_loc * self.lambda_loc
        return loss, loss_conf.item(), loss_cls.item(), loss_loc.item()

    def get_target(self, target, anchors, in_w, in_h, ignore_threshold):
        # &#x8BA1;&#x7B97;&#x4E00;&#x5171;&#x6709;&#x591A;&#x5C11;&#x5F20;&#x56FE;&#x7247;
        bs = len(target)
        # &#x83B7;&#x5F97;&#x5148;&#x9A8C;&#x6846;
        anchor_index = [[0,1,2],[3,4,5],[6,7,8]][[13,26,52].index(in_w)]
        subtract_index = [0,3,6][[13,26,52].index(in_w)]
        # &#x521B;&#x5EFA;&#x5168;&#x662F;0&#x6216;&#x8005;&#x5168;&#x662F;1&#x7684;&#x9635;&#x5217;
        mask = torch.zeros(bs, int(self.num_anchors/3), in_h, in_w, requires_grad=False)
        noobj_mask = torch.ones(bs, int(self.num_anchors/3), in_h, in_w, requires_grad=False)

        tx = torch.zeros(bs, int(self.num_anchors/3), in_h, in_w, requires_grad=False)
        ty = torch.zeros(bs, int(self.num_anchors/3), in_h, in_w, requires_grad=False)
        tw = torch.zeros(bs, int(self.num_anchors/3), in_h, in_w, requires_grad=False)
        th = torch.zeros(bs, int(self.num_anchors/3), in_h, in_w, requires_grad=False)
        t_box = torch.zeros(bs, int(self.num_anchors/3), in_h, in_w, 4, requires_grad=False)
        tconf = torch.zeros(bs, int(self.num_anchors/3), in_h, in_w, requires_grad=False)
        tcls = torch.zeros(bs, int(self.num_anchors/3), in_h, in_w, self.num_classes, requires_grad=False)

        box_loss_scale_x = torch.zeros(bs, int(self.num_anchors/3), in_h, in_w, requires_grad=False)
        box_loss_scale_y = torch.zeros(bs, int(self.num_anchors/3), in_h, in_w, requires_grad=False)
        for b in range(bs):
            for t in range(target[b].shape[0]):
                # &#x8BA1;&#x7B97;&#x51FA;&#x5728;&#x7279;&#x5F81;&#x5C42;&#x4E0A;&#x7684;&#x70B9;&#x4F4D;
                gx = target[b][t, 0] * in_w
                gy = target[b][t, 1] * in_h

                gw = target[b][t, 2] * in_w
                gh = target[b][t, 3] * in_h

                # &#x8BA1;&#x7B97;&#x51FA;&#x5C5E;&#x4E8E;&#x54EA;&#x4E2A;&#x7F51;&#x683C;
                gi = int(gx)
                gj = int(gy)

                # &#x8BA1;&#x7B97;&#x771F;&#x5B9E;&#x6846;&#x7684;&#x4F4D;&#x7F6E;
                gt_box = torch.FloatTensor(np.array([0, 0, gw, gh])).unsqueeze(0)

                # &#x8BA1;&#x7B97;&#x51FA;&#x6240;&#x6709;&#x5148;&#x9A8C;&#x6846;&#x7684;&#x4F4D;&#x7F6E;
                anchor_shapes = torch.FloatTensor(np.concatenate((np.zeros((self.num_anchors, 2)),
                                                                  np.array(anchors)), 1))
                # &#x8BA1;&#x7B97;&#x91CD;&#x5408;&#x7A0B;&#x5EA6;
                anch_ious = bbox_iou(gt_box, anchor_shapes)

                # Find the best matching anchor box
                best_n = np.argmax(anch_ious)
                if best_n not in anchor_index:
                    continue
                # Masks
                if (gj &lt; in_h) and (gi &lt; in_w):
                    best_n = best_n - subtract_index
                    # &#x5224;&#x5B9A;&#x54EA;&#x4E9B;&#x5148;&#x9A8C;&#x6846;&#x5185;&#x90E8;&#x771F;&#x5B9E;&#x7684;&#x5B58;&#x5728;&#x7269;&#x4F53;
                    noobj_mask[b, best_n, gj, gi] = 0
                    mask[b, best_n, gj, gi] = 1
                    # &#x8BA1;&#x7B97;&#x5148;&#x9A8C;&#x6846;&#x4E2D;&#x5FC3;&#x8C03;&#x6574;&#x53C2;&#x6570;
                    tx[b, best_n, gj, gi] = gx
                    ty[b, best_n, gj, gi] = gy
                    # &#x8BA1;&#x7B97;&#x5148;&#x9A8C;&#x6846;&#x5BBD;&#x9AD8;&#x8C03;&#x6574;&#x53C2;&#x6570;
                    tw[b, best_n, gj, gi] = gw
                    th[b, best_n, gj, gi] = gh
                    # &#x7528;&#x4E8E;&#x83B7;&#x5F97;xywh&#x7684;&#x6BD4;&#x4F8B;
                    box_loss_scale_x[b, best_n, gj, gi] = target[b][t, 2]
                    box_loss_scale_y[b, best_n, gj, gi] = target[b][t, 3]
                    # &#x7269;&#x4F53;&#x7F6E;&#x4FE1;&#x5EA6;
                    tconf[b, best_n, gj, gi] = 1
                    # &#x79CD;&#x7C7B;
                    tcls[b, best_n, gj, gi, int(target[b][t, 4])] = 1
                else:
                    print(&apos;Step {0} out of bound&apos;.format(b))
                    print(&apos;gj: {0}, height: {1} | gi: {2}, width: {3}&apos;.format(gj, in_h, gi, in_w))
                    continue
        t_box[...,0] = tx
        t_box[...,1] = ty
        t_box[...,2] = tw
        t_box[...,3] = th
        return mask, noobj_mask, t_box, tconf, tcls, box_loss_scale_x, box_loss_scale_y

    def get_ignore(self,prediction,target,scaled_anchors,in_w, in_h,noobj_mask):
        bs = len(target)
        anchor_index = [[0,1,2],[3,4,5],[6,7,8]][[13,26,52].index(in_w)]
        scaled_anchors = np.array(scaled_anchors)[anchor_index]
        # &#x5148;&#x9A8C;&#x6846;&#x7684;&#x4E2D;&#x5FC3;&#x4F4D;&#x7F6E;&#x7684;&#x8C03;&#x6574;&#x53C2;&#x6570;
        x = torch.sigmoid(prediction[..., 0])  
        y = torch.sigmoid(prediction[..., 1])
        # &#x5148;&#x9A8C;&#x6846;&#x7684;&#x5BBD;&#x9AD8;&#x8C03;&#x6574;&#x53C2;&#x6570;
        w = prediction[..., 2]  # Width
        h = prediction[..., 3]  # Height

        FloatTensor = torch.cuda.FloatTensor if x.is_cuda else torch.FloatTensor
        LongTensor = torch.cuda.LongTensor if x.is_cuda else torch.LongTensor

        # &#x751F;&#x6210;&#x7F51;&#x683C;&#xFF0C;&#x5148;&#x9A8C;&#x6846;&#x4E2D;&#x5FC3;&#xFF0C;&#x7F51;&#x683C;&#x5DE6;&#x4E0A;&#x89D2;
        grid_x = torch.linspace(0, in_w - 1, in_w).repeat(in_w, 1).repeat(
            int(bs*self.num_anchors/3), 1, 1).view(x.shape).type(FloatTensor)
        grid_y = torch.linspace(0, in_h - 1, in_h).repeat(in_h, 1).t().repeat(
            int(bs*self.num_anchors/3), 1, 1).view(y.shape).type(FloatTensor)

        # &#x751F;&#x6210;&#x5148;&#x9A8C;&#x6846;&#x7684;&#x5BBD;&#x9AD8;
        anchor_w = FloatTensor(scaled_anchors).index_select(1, LongTensor([0]))
        anchor_h = FloatTensor(scaled_anchors).index_select(1, LongTensor([1]))

        anchor_w = anchor_w.repeat(bs, 1).repeat(1, 1, in_h * in_w).view(w.shape)
        anchor_h = anchor_h.repeat(bs, 1).repeat(1, 1, in_h * in_w).view(h.shape)

        # &#x8BA1;&#x7B97;&#x8C03;&#x6574;&#x540E;&#x7684;&#x5148;&#x9A8C;&#x6846;&#x4E2D;&#x5FC3;&#x4E0E;&#x5BBD;&#x9AD8;
        pred_boxes = FloatTensor(prediction[..., :4].shape)
        pred_boxes[..., 0] = x + grid_x
        pred_boxes[..., 1] = y + grid_y
        pred_boxes[..., 2] = torch.exp(w) * anchor_w
        pred_boxes[..., 3] = torch.exp(h) * anchor_h
        for i in range(bs):
            pred_boxes_for_ignore = pred_boxes[i]
            pred_boxes_for_ignore = pred_boxes_for_ignore.view(-1, 4)

            for t in range(target[i].shape[0]):
                gx = target[i][t, 0] * in_w
                gy = target[i][t, 1] * in_h
                gw = target[i][t, 2] * in_w
                gh = target[i][t, 3] * in_h
                gt_box = torch.FloatTensor(np.array([gx, gy, gw, gh])).unsqueeze(0).type(FloatTensor)

                anch_ious = bbox_iou(gt_box, pred_boxes_for_ignore, x1y1x2y2=False)
                anch_ious = anch_ious.view(pred_boxes[i].size()[:3])
                noobj_mask[i][anch_ious&gt;self.ignore_threshold] = 0
        return noobj_mask, pred_boxes
</code></pre><h1 id="&#x8BAD;&#x7EC3;&#x81EA;&#x5DF1;&#x7684;-yolov4-&#x6A21;&#x578B;"><a name="&#x8BAD;&#x7EC3;&#x81EA;&#x5DF1;&#x7684;-yolov4-&#x6A21;&#x578B;" class="anchor-navigation-ex-anchor" href="#&#x8BAD;&#x7EC3;&#x81EA;&#x5DF1;&#x7684;-yolov4-&#x6A21;&#x578B;"><i class="fa fa-link" aria-hidden="true"></i></a>8. &#x8BAD;&#x7EC3;&#x81EA;&#x5DF1;&#x7684; YOLOV4 &#x6A21;&#x578B;</h1>
<p>yolo4 &#x6574;&#x4F53;&#x7684;&#x6587;&#x4EF6;&#x5939;&#x6784;&#x67B6;&#x5982;&#x4E0B;&#xFF1A;<br><img src="https://img-blog.csdnimg.cn/20200511215524248.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDc5MTk2NA==,size_16,color_FFFFFF,t_70#pic_center" alt=""><br>&#x672C;&#x6587;&#x4F7F;&#x7528; VOC &#x683C;&#x5F0F;&#x8FDB;&#x884C;&#x8BAD;&#x7EC3;&#x3002;<br>&#x8BAD;&#x7EC3;&#x524D;&#x5C06;&#x6807;&#x7B7E;&#x6587;&#x4EF6;&#x653E;&#x5728; VOCdevkit &#x6587;&#x4EF6;&#x5939;&#x4E0B;&#x7684; VOC2007 &#x6587;&#x4EF6;&#x5939;&#x4E0B;&#x7684; Annotation &#x4E2D;&#x3002;<br><img src="https://img-blog.csdnimg.cn/20191127171146309.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDc5MTk2NA==,size_16,color_FFFFFF,t_70#pic_center" alt=""><br>&#x8BAD;&#x7EC3;&#x524D;&#x5C06;&#x56FE;&#x7247;&#x6587;&#x4EF6;&#x653E;&#x5728; VOCdevkit &#x6587;&#x4EF6;&#x5939;&#x4E0B;&#x7684; VOC2007 &#x6587;&#x4EF6;&#x5939;&#x4E0B;&#x7684; JPEGImages &#x4E2D;&#x3002;<br><img src="https://img-blog.csdnimg.cn/20191127171315165.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDc5MTk2NA==,size_16,color_FFFFFF,t_70#pic_center" alt=""><br>&#x5728;&#x8BAD;&#x7EC3;&#x524D;&#x5229;&#x7528; voc2yolo3.py &#x6587;&#x4EF6;&#x751F;&#x6210;&#x5BF9;&#x5E94;&#x7684; txt&#x3002;<br><img src="https://img-blog.csdnimg.cn/20200511215606296.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDc5MTk2NA==,size_16,color_FFFFFF,t_70#pic_center" alt=""><br>&#x518D;&#x8FD0;&#x884C;&#x6839;&#x76EE;&#x5F55;&#x4E0B;&#x7684; voc_annotation.py&#xFF0C;&#x8FD0;&#x884C;&#x524D;&#x9700;&#x8981;&#x5C06; classes &#x6539;&#x6210;&#x4F60;&#x81EA;&#x5DF1;&#x7684; classes&#x3002;</p>
<pre><code>classes = [&quot;aeroplane&quot;, &quot;bicycle&quot;, &quot;bird&quot;, &quot;boat&quot;, &quot;bottle&quot;, &quot;bus&quot;, &quot;car&quot;, &quot;cat&quot;, &quot;chair&quot;, &quot;cow&quot;, &quot;diningtable&quot;, &quot;dog&quot;, &quot;horse&quot;, &quot;motorbike&quot;, &quot;person&quot;, &quot;pottedplant&quot;, &quot;sheep&quot;, &quot;sofa&quot;, &quot;train&quot;, &quot;tvmonitor&quot;]
</code></pre><p><img src="https://img-blog.csdnimg.cn/20200511215635790.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDc5MTk2NA==,size_16,color_FFFFFF,t_70#pic_center" alt=""><br>&#x5C31;&#x4F1A;&#x751F;&#x6210;&#x5BF9;&#x5E94;&#x7684; 2007_train.txt&#xFF0C;&#x6BCF;&#x4E00;&#x884C;&#x5BF9;&#x5E94;&#x5176;&#x56FE;&#x7247;&#x4F4D;&#x7F6E;&#x53CA;&#x5176;&#x771F;&#x5B9E;&#x6846;&#x7684;&#x4F4D;&#x7F6E;&#x3002;<br><img src="https://img-blog.csdnimg.cn/2020051121565488.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDc5MTk2NA==,size_16,color_FFFFFF,t_70#pic_center" alt=""><br>&#x5728;&#x8BAD;&#x7EC3;&#x524D;&#x9700;&#x8981;&#x4FEE;&#x6539; model_data &#x91CC;&#x9762;&#x7684; voc_classes.txt &#x6587;&#x4EF6;&#xFF0C;&#x9700;&#x8981;&#x5C06; classes &#x6539;&#x6210;&#x4F60;&#x81EA;&#x5DF1;&#x7684; classes&#x3002;<br><img src="https://img-blog.csdnimg.cn/20200511215711964.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDc5MTk2NA==,size_16,color_FFFFFF,t_70#pic_center" alt=""><br>&#x8FD0;&#x884C; train.py &#x5373;&#x53EF;&#x5F00;&#x59CB;&#x8BAD;&#x7EC3;&#x3002;<br><img src="https://img-blog.csdnimg.cn/20200519160129375.png#pic_center" alt=""></p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="YOLOÂÆûÈ™å/Á¨îËÆ∞ - Âú®ÊúçÂä°Âô®‰∏äÁî® YOLOv4 ËÆ≠ÁªÉÂíåÊµãËØïÊï∞ÊçÆÈõÜ.html" class="navigation navigation-prev " aria-label="Previous page: Á¨îËÆ∞ - Âú®ÊúçÂä°Âô®‰∏äÁî® YOLOv4 ËÆ≠ÁªÉÂíåÊµãËØïÊï∞ÊçÆÈõÜ">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="yolo--- ÂèÇÊï∞Ëß£Èáä‰πã cfg Êñá‰ª∂ÂèÇÊï∞.html" class="navigation navigation-next " aria-label="Next page: yolo--- ÂèÇÊï∞Ëß£Èáä‰πã cfg Êñá‰ª∂ÂèÇÊï∞">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"üåüPytorch Êê≠Âª∫ YoloV4 ÁõÆÊ†áÊ£ÄÊµãÂπ≥Âè∞","level":"1.7.4","depth":2,"next":{"title":"yolo--- ÂèÇÊï∞Ëß£Èáä‰πã cfg Êñá‰ª∂ÂèÇÊï∞","level":"1.7.5","depth":2,"path":"5 - ÂÆûÈ™åÁ¨îËÆ∞/yolo--- ÂèÇÊï∞Ëß£Èáä‰πã cfg Êñá‰ª∂ÂèÇÊï∞.md","ref":"5 - ÂÆûÈ™åÁ¨îËÆ∞/yolo--- ÂèÇÊï∞Ëß£Èáä‰πã cfg Êñá‰ª∂ÂèÇÊï∞.md","articles":[]},"previous":{"title":"Á¨îËÆ∞ - Âú®ÊúçÂä°Âô®‰∏äÁî® YOLOv4 ËÆ≠ÁªÉÂíåÊµãËØïÊï∞ÊçÆÈõÜ","level":"1.7.3.5","depth":3,"path":"5 - ÂÆûÈ™åÁ¨îËÆ∞/YOLOÂÆûÈ™å/Á¨îËÆ∞ - Âú®ÊúçÂä°Âô®‰∏äÁî® YOLOv4 ËÆ≠ÁªÉÂíåÊµãËØïÊï∞ÊçÆÈõÜ.md","ref":"5 - ÂÆûÈ™åÁ¨îËÆ∞/YOLOÂÆûÈ™å/Á¨îËÆ∞ - Âú®ÊúçÂä°Âô®‰∏äÁî® YOLOv4 ËÆ≠ÁªÉÂíåÊµãËØïÊï∞ÊçÆÈõÜ.md","articles":[]},"dir":"ltr"},"config":{"plugins":["expandable-chapters","github-buttons","copy-code-button","anchor-navigation-ex","-highlight","-lunr","-search","search-pro","splitter"],"ignores":["_book","node_modules"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"splitter":{},"search-pro":{},"fontsettings":{"theme":"white","family":"sans","size":2},"anchor-navigation-ex":{"associatedWithSummary":true,"float":{"floatIcon":"fa fa-navicon","level1Icon":"","level2Icon":"","level3Icon":"","showLevelIcon":false},"mode":"float","multipleH1":true,"pageTop":{"level1Icon":"","level2Icon":"","level3Icon":"","showLevelIcon":false},"printLog":false,"showGoTop":true,"showLevel":true},"github-buttons":{},"copy-code-button":{},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"expandable-chapters":{}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"Summary","gitbook":"*"},"file":{"path":"5 - ÂÆûÈ™åÁ¨îËÆ∞/üåüPytorch Êê≠Âª∫ YoloV4 ÁõÆÊ†áÊ£ÄÊµãÂπ≥Âè∞.md","mtime":"2021-08-03T09:22:20.858Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2021-08-03T09:23:02.254Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-github-buttons/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-copy-code-button/toggle.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search-pro/jquery.mark.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search-pro/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-splitter/splitter.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

